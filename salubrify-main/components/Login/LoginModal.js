// @ts-nocheck
import { Fragment, useState } from 'react'
import { Dialog, Transition } from '@headlessui/react'
import Button from '../common/Button/largeButton'
import {auth,provider} from '../../database/firebase'
import {signInWithPhoneNumber, signInWithPopup } from "firebase/auth";


const LoginModal = ({ open, setOpen, setOtpOpen }) => {
    const [phoneNumber, setPhoneNumber] = useState('');


    const generateCaptcha = () => {
        window.recaptchaVerifier = new RecaptchaVerifier('recaptcha-container', {
            'size': 'invisible',
            'callback': (response) => {
                // reCAPTCHA solved, allow signInWithPhoneNumber.
                // onSignInSubmit();
                handleClick();
            }
        },auth);
    }

    const handleClick = (e)=>{
        setOpen(false);  
        setOtpOpen(true);
        e.preventDefault();
        generateCaptcha();
        signInWithPhoneNumber(auth, phoneNumber, window.recaptchaVerifier)
        .then((confirmationResult) => {
            // SMS sent. Prompt user to type the code from the message, then sign the
            // user in with confirmationResult.confirm(code).
            window.confirmationResult = confirmationResult;
            // ...
        }
        ).catch((error) => {
            console.log(error);
            // Error; SMS not sent
            // ...
        });
    }
    const signInWithGoogle = () => {
         signInWithPopup(auth, provider)
        .then((result) => {
           const response = result.user;
              console.log(response);
        }
        ).catch((error) => {
            console.log(error);
            
    // ...
  });

     }



    return (
        <Transition.Root show={open} as={Fragment}>
            <Dialog as="div" className="relative z-10" onClose={setOpen}>
                <Transition.Child
                    as={Fragment}
                    enter="ease-out duration-300"
                    enterFrom="opacity-0"
                    enterTo="opacity-100"
                    leave="ease-in duration-200"
                    leaveFrom="opacity-100"
                    leaveTo="opacity-0"
                >
                    <div className="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity" />
                </Transition.Child>

                <div className="fixed inset-0 z-10 overflow-y-auto">
                    <div className="flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0">
                        <Transition.Child
                            as={Fragment}
                            enter="ease-out duration-300"
                            enterFrom="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
                            enterTo="opacity-100 translate-y-0 sm:scale-100"
                            leave="ease-in duration-200"
                            leaveFrom="opacity-100 translate-y-0 sm:scale-100"
                            leaveTo="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
                        >
                            <Dialog.Panel className="relative transform overflow-hidden rounded-2xl bg-secondary px-4 pt-5 pb-4 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-sm sm:p-6">
                                <div>

                                    <div className="mt-3 text-center sm:mt-5">
                                        <div className='flex justify-center'>
                                            <svg width="64" height="121" viewBox="0 0 104 161" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M64.3518 95.0851C62.0502 104.936 54.9 110.275 50.7265 113.129C48.2715 114.786 43.2387 118.162 36.2113 119.543C34.6462 119.85 32.9584 120.065 31.2092 120.126C30.0431 120.157 28.9077 120.157 27.8029 120.065C13.2877 119.083 3.74388 108.434 2.20951 106.685C2.08676 107.606 1.96402 108.526 1.84127 109.447C1.22752 109.385 0.613751 109.324 0 109.263C0.0306875 102.573 0.0613713 95.8829 0.0920589 89.1931L1.84127 89.2851C1.59577 91.0343 1.35024 94.2258 2.48568 97.939C3.77456 102.205 6.16817 104.936 7.45705 106.225C9.23693 108.158 12.3057 110.981 16.8474 113.037C17.9829 113.559 22.2178 115.523 27.8029 115.83C30.35 115.983 33.204 115.799 36.1806 114.94C37.2547 114.664 38.3901 114.265 39.4949 113.774C45.6937 111.012 49.008 106.439 50.1742 104.752C54.5625 98.4914 57.4777 88.7327 53.8566 80.355C53.0587 78.4831 52.1075 77.1635 50.6345 75.4757V75.445H50.6037C50.2662 75.0767 49.9286 74.6778 49.5297 74.2175C49.1307 73.7572 48.7011 73.2969 48.2408 72.7752C47.8726 72.3763 47.5657 72.0387 47.1667 71.7011L47.136 71.6705C44.4355 68.9393 41.8578 67.1287 36.1192 63.2314C34.5235 62.1573 32.7129 60.8991 30.5648 59.4568C29.5828 58.7817 28.6622 58.168 27.8336 57.5849C20.2538 52.3987 18.6887 51.1405 17.1236 49.6982C12.3364 45.3712 9.57449 42.8549 7.45705 38.6507C6.78193 37.3004 1.62644 26.5291 6.99676 15.4509C11.4465 6.2753 20.1617 3.08378 23.3839 1.91766C32.0378 -1.24316 39.5255 0.321946 41.8885 0.905009C50.4196 3.02245 55.6058 8.05521 57.5392 10.1113C57.7233 8.69965 57.9074 7.288 58.0915 5.87638H60.3931C60.4544 12.689 60.5158 19.5017 60.5772 26.3143C59.8714 26.1609 59.1656 26.0073 58.4597 25.8539C58.3677 24.074 57.5698 12.4128 48.517 6.33667C36.9478 -1.45797 18.3511 4.21925 13.9015 15.1747C10.9248 22.5704 15.0369 30.7026 15.7427 32.1142C16.9702 34.5078 18.8115 37.1776 27.5267 43.8982C27.6495 43.9903 27.7722 44.0824 27.8643 44.1438C31.1171 46.6294 33.787 48.5321 36.1192 50.0664C43.1467 54.7923 46.8906 56.5108 52.5678 62.3107C55.0535 64.8578 57.6925 67.6197 60.0862 71.6398C60.5465 72.407 60.9762 73.2355 61.4058 74.0947C61.6206 74.4937 61.8354 74.954 62.0809 75.445C64.1063 79.6799 66.2851 86.8608 64.3518 95.0851Z" fill="#EB1754" />
                                                <path d="M36.1824 114.94C33.2057 115.799 30.3518 115.983 27.8047 115.83C27.8354 96.4044 27.8354 77.0099 27.8354 57.5847C28.664 58.1678 29.5845 58.7815 30.5665 59.4566C32.7147 60.8989 34.5252 62.1572 36.121 63.2312V71.7009V75.4755C36.121 75.4755 36.1824 101.775 36.1824 114.94Z" fill="#EC008C" />
                                                <path d="M104 147.131C104 148.205 103.141 149.064 102.067 149.034L94.2412 148.972C93.3513 148.972 92.6455 149.678 92.6455 150.568V153.238C92.6455 157.043 89.546 160.173 85.7408 160.204C85.7101 160.204 85.71 160.204 85.6793 160.204C84.8201 160.204 84.145 159.498 84.145 158.639L84.2064 150.507C84.2064 149.647 83.5006 148.942 82.6413 148.942L74.4784 148.849C73.435 148.849 72.6065 148.021 72.6065 146.978L72.5758 144.093C72.5758 142.16 74.1409 140.595 76.0742 140.595H82.7026C83.5619 140.595 84.2677 139.889 84.2677 139.029L84.2985 134.518C84.2985 133.475 84.3292 128.933 84.3292 128.504C84.3599 110.797 84.3598 93.1209 84.3905 75.4448H62.0807C61.8352 74.9538 61.6204 74.4935 61.4056 74.0946C60.9759 73.2353 60.5463 72.4068 60.0859 71.6396L84.3905 71.5476C84.3905 55.989 84.4212 40.4304 84.4212 24.8718C84.2678 24.3501 83.8074 22.7543 82.2731 21.5575C80.3704 20.0538 78.2223 20.2686 77.7927 20.2993C77.762 19.7469 77.7313 19.1639 77.7007 18.5808C84.8815 18.6422 92.0317 18.7343 99.1819 18.7956C99.1512 19.3173 99.1512 19.839 99.1205 20.3914C95.8062 20.821 93.2285 22.3861 92.7068 24.5342C92.5841 24.9025 92.5534 25.3628 92.6148 25.9152C92.6761 60.1932 92.7069 94.5018 92.7682 128.78C92.7682 129.363 92.6148 132.8 92.6148 134.426V138.999C92.6148 139.858 93.3206 140.564 94.1799 140.564H100.501C102.404 140.564 103.938 142.068 103.969 143.97L104 147.131Z" fill="#EC008C" />
                                            </svg>
                                        </div>

                                        <div className="mt-2">
                                            <div className='flex justify-between gap-3'>
                                                <select name="" id="" className='bg-[#F7EDF0] focus:outline-none px-3 py-2 rounded-md'>
                                                    <option value="">+91 </option>
                                                </select>
                                                <input type="phone" className='bg-[#F7EDF0] focus:outline-none px-3 py-2 w-full rounded-md' placeholder='Eg. - 45679846512' value={phoneNumber} onChange={(e) => setPhoneNumber(e.target.value)}/>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div>
                                    <svg width="351" height="34" viewBox="0 0 551 34" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <line x1="4.37114e-08" y1="16.5" x2="551" y2="16.5" stroke="#E2E2E2" />
                                        <circle cx="275" cy="17" r="16.5" fill="#FFF5F8" stroke="#E2E2E2" />
                                        <path d="M272.5 21.06C271.9 21.06 271.356 20.94 270.868 20.7C270.38 20.46 269.96 20.136 269.608 19.728C269.256 19.312 268.984 18.848 268.792 18.336C268.6 17.816 268.504 17.284 268.504 16.74C268.504 16.172 268.604 15.632 268.804 15.12C269.004 14.6 269.284 14.14 269.644 13.74C270.012 13.332 270.44 13.012 270.928 12.78C271.416 12.54 271.944 12.42 272.512 12.42C273.112 12.42 273.656 12.544 274.144 12.792C274.632 13.04 275.048 13.372 275.392 13.788C275.744 14.204 276.016 14.668 276.208 15.18C276.4 15.692 276.496 16.216 276.496 16.752C276.496 17.32 276.396 17.864 276.196 18.384C275.996 18.896 275.716 19.356 275.356 19.764C274.996 20.164 274.572 20.48 274.084 20.712C273.596 20.944 273.068 21.06 272.5 21.06ZM269.344 16.74C269.344 17.204 269.42 17.652 269.572 18.084C269.724 18.508 269.94 18.888 270.22 19.224C270.5 19.552 270.832 19.816 271.216 20.016C271.608 20.208 272.036 20.304 272.5 20.304C272.988 20.304 273.424 20.204 273.808 20.004C274.2 19.796 274.532 19.524 274.804 19.188C275.084 18.844 275.296 18.46 275.44 18.036C275.584 17.612 275.656 17.18 275.656 16.74C275.656 16.276 275.58 15.832 275.428 15.408C275.276 14.984 275.056 14.604 274.768 14.268C274.488 13.932 274.156 13.668 273.772 13.476C273.388 13.284 272.964 13.188 272.5 13.188C272.02 13.188 271.584 13.288 271.192 13.488C270.808 13.688 270.476 13.96 270.196 14.304C269.924 14.64 269.712 15.02 269.56 15.444C269.416 15.868 269.344 16.3 269.344 16.74ZM280.985 15.468C280.441 15.484 279.961 15.636 279.545 15.924C279.137 16.212 278.849 16.608 278.681 17.112V21H277.865V14.748H278.633V16.248C278.849 15.808 279.133 15.452 279.485 15.18C279.845 14.908 280.225 14.756 280.625 14.724C280.705 14.716 280.773 14.712 280.829 14.712C280.893 14.712 280.945 14.716 280.985 14.724V15.468Z" fill="black" />
                                    </svg>
                                </div>


                                <div className='border-[1px] border-primary flex justify-between p-3 mt-4 rounded-md text-primary font-semibold mx-5'>
                                    <p>Continue with </p>
                                    <div className='flex gap-4 items-center'>
                                        <div>
                                            <svg width="20" height="21" viewBox="0 0 20 21" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M19.7392 9.57C19.7146 9.32504 19.5995 9.09809 19.4164 8.93349C19.2333 8.7689 18.9954 8.67852 18.7492 8.68H11.1992C10.6492 8.68 10.1992 9.13 10.1992 9.68V11.39C10.1992 11.94 10.6492 12.39 11.1992 12.39H15.7092C15.5992 13.31 14.9992 14.7 13.6692 15.63C12.8192 16.22 11.6892 16.63 10.1992 16.63C10.1292 16.63 10.0692 16.63 9.99922 16.62C7.44922 16.54 5.28922 14.83 4.50922 12.48C4.29292 11.8422 4.18147 11.1735 4.17922 10.5C4.17922 9.81 4.29922 9.14 4.49922 8.52C4.55922 8.34 4.62922 8.16 4.70922 7.98C5.62922 5.91 7.63922 4.45 9.99922 4.38C10.0592 4.37 10.1292 4.37 10.1992 4.37C11.6292 4.37 12.6992 4.84 13.4492 5.36C13.8392 5.63 14.3592 5.57 14.6992 5.24L16.0892 3.88C16.5292 3.45 16.4892 2.72 15.9892 2.36C14.3992 1.19 12.4592 0.5 10.1992 0.5C10.1292 0.5 10.0692 0.5 9.99922 0.51C8.18057 0.542215 6.40547 1.07184 4.86649 2.04141C3.32752 3.01098 2.08344 4.38348 1.26922 6.01C0.589219 7.37 0.199219 8.89 0.199219 10.5C0.199219 12.11 0.589219 13.63 1.26922 14.99H1.27922C2.0923 16.6153 3.33474 17.9871 4.87187 18.9566C6.409 19.9261 8.18218 20.4564 9.99922 20.49C10.0692 20.5 10.1292 20.5 10.1992 20.5C12.8992 20.5 15.1692 19.61 16.8192 18.08C18.7092 16.33 19.7992 13.77 19.7992 10.72C19.7992 10.29 19.7792 9.92 19.7392 9.57Z" fill="#EB1754" />
                                            </svg>
                                        </div>

                                        <div>
                                            <svg width="20" height="17" viewBox="0 0 20 17" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M18 0.5H2C0.9 0.5 0.00999999 1.4 0.00999999 2.5L0 14.5C0 15.6 0.9 16.5 2 16.5H18C19.1 16.5 20 15.6 20 14.5V2.5C20 1.4 19.1 0.5 18 0.5ZM18 4.5L10 9.5L2 4.5V2.5L10 7.5L18 2.5V4.5Z" fill="#EB1754" />
                                            </svg>

                                        </div>

                                        <div>
                                            <svg width="20" height="21" viewBox="0 0 20 21" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M20 14.69C20 18.33 17.83 20.5 14.19 20.5H13C12.45 20.5 12 20.05 12 19.5V13.73C12 13.46 12.22 13.23 12.49 13.23L14.25 13.2C14.39 13.19 14.51 13.09 14.54 12.95L14.89 11.04C14.8968 10.9967 14.8941 10.9525 14.8822 10.9103C14.8702 10.8681 14.8492 10.8291 14.8207 10.7958C14.7922 10.7625 14.7568 10.7358 14.717 10.7176C14.6771 10.6993 14.6338 10.6899 14.59 10.69L12.46 10.72C12.18 10.72 11.96 10.5 11.95 10.23L11.91 7.78C11.91 7.62 12.04 7.48 12.21 7.48L14.61 7.44C14.78 7.44 14.91 7.31 14.91 7.14L14.87 4.74C14.87 4.57 14.74 4.44 14.57 4.44L11.87 4.48C11.4759 4.48599 11.0868 4.56969 10.725 4.72632C10.3633 4.88295 10.0361 5.10942 9.76201 5.39276C9.48796 5.6761 9.27252 6.01073 9.12803 6.37748C8.98354 6.74422 8.91285 7.13588 8.92 7.53L8.97 10.28C8.98 10.56 8.76 10.78 8.48 10.79L7.28 10.81C7.11 10.81 6.98 10.94 6.98 11.11L7.01 13.01C7.01 13.18 7.14 13.31 7.31 13.31L8.51 13.29C8.79 13.29 9.01 13.51 9.02 13.78L9.11 19.48C9.12 20.04 8.67 20.5 8.11 20.5H5.81C2.17 20.5 0 18.33 0 14.68V6.31C0 2.67 2.17 0.5 5.81 0.5H14.19C17.83 0.5 20 2.67 20 6.31V14.69Z" fill="#EB1754" />
                                            </svg>
                                        </div>

                                    </div>
                                </div>


                                <p className='mt-5 text-center  text-[#989898]'>
                                    *By clicking you accept Salubrify’s <span className='text-primary'>Terms & Conditions</span> and <span className='text-primary'>Privacy policies</span>
                                </p>
                                
                                <div id='recaptcha-container'/>
                                <div className="mt-5 sm:mt-6 text-center">
                                    <Button buttonText='Continue' onClick={signInWithGoogle} />
                                </div>
                                
                            </Dialog.Panel>
                        </Transition.Child>
                    </div>
                </div>
            </Dialog>
        </Transition.Root>
    )
}

export default LoginModal