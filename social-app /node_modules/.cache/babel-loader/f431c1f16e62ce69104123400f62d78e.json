{"ast":null,"code":"import _regeneratorRuntime from\"/home/codegama/bhawya/source_code/fx-frontend-base/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _slicedToArray from\"/home/codegama/bhawya/source_code/fx-frontend-base/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _asyncToGenerator from\"/home/codegama/bhawya/source_code/fx-frontend-base/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React,{useEffect,useState}from\"react\";import{connect}from\"react-redux\";import{translate,t}from\"react-multi-lang\";import AgoraRTC from\"agora-rtc-sdk-ng\";import{Form,Button,Container,Row,Col,Table,Media,Image}from\"react-bootstrap\";import{endAudioCallStart,joinAudioCallStart}from\"../../store/actions/PrivateCallAction\";import configuration from\"react-global-configuration\";import{Link}from\"react-router-dom\";var client=AgoraRTC.createClient({mode:\"live\",codec:\"vp8\"});var $=window.$;var AgoraOnetoOneAudioCall=function AgoraOnetoOneAudioCall(props){var rtc={// For the local client.\nclient:null,// For the local audio and video tracks.\nlocalAudioTrack:null// localVideoTrack: null,\n};var localTracks={audioTrack:null};var localTrackState={audioTrackEnabled:true};var options={// Pass your app ID here.\nappId:configuration.get(\"configData.agora_app_id\"),// Set the channel name.\nchannel:\"demo_channel_name\",// Pass a token if your project enables the App Certificate.\ntoken:null,uid:null};var remoteUsers={};function startBasicCall(){return _startBasicCall.apply(this,arguments);}function _startBasicCall(){_startBasicCall=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$Promise$all,_yield$Promise$all2;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:// Create an AgoraRTCClient object.\nrtc.client=AgoraRTC.createClient({mode:\"rtc\",codec:\"vp8\"});rtc.client.on(\"user-published\",handleUserPublished);rtc.client.on(\"user-unpublished\",handleUserUnpublished);_context.t0=Promise;_context.next=6;return rtc.client.join(options.appId,options.channel,options.token,null);case 6:_context.t1=_context.sent;_context.next=9;return AgoraRTC.createMicrophoneAudioTrack();case 9:_context.t2=rtc.localAudioTrack=_context.sent;_context.t3=[_context.t1,_context.t2];_context.next=13;return _context.t0.all.call(_context.t0,_context.t3);case 13:_yield$Promise$all=_context.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,2);options.uid=_yield$Promise$all2[0];localTracks.audioTrack=_yield$Promise$all2[1];_context.next=19;return rtc.client.publish([rtc.localAudioTrack]);case 19:console.log(\"publish success!\");props.dispatch(joinAudioCallStart({audio_call_request_id:props.audioCallData.audio_call_request_id}));case 21:case\"end\":return _context.stop();}}},_callee);}));return _startBasicCall.apply(this,arguments);}function subscribe(_x,_x2){return _subscribe.apply(this,arguments);}function _subscribe(){_subscribe=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(user,mediaType){var uid;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:uid=user.uid;// subscribe to a remote user\n_context2.next=3;return rtc.client.subscribe(user,mediaType);case 3:console.log(\"subscribe success\");if(mediaType==='audio'){user.audioTrack.play();}case 5:case\"end\":return _context2.stop();}}},_callee2);}));return _subscribe.apply(this,arguments);}function handleUserPublished(user,mediaType){var id=user.uid;remoteUsers[id]=user;subscribe(user,mediaType);}function handleUserUnpublished(user){// const id = user.uid;\n// delete remoteUsers[id];\n// $(`#player-wrapper-${id}`).remove();\n}startBasicCall();function leaveCall(_x3){return _leaveCall.apply(this,arguments);}function _leaveCall(){_leaveCall=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(is_owner){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!is_owner){_context3.next=7;break;}// Destroy the local audio track.\nrtc.localAudioTrack.close();// Leave the channel.\n_context3.next=4;return rtc.client.leave();case 4:props.dispatch(endAudioCallStart({audio_call_request_id:props.audioCallData.audio_call_request_id}));_context3.next=9;break;case 7:_context3.next=9;return rtc.client.leave();case 9:window.location.assign(\"/audio-calls-history\");case 10:case\"end\":return _context3.stop();}}},_callee3);}));return _leaveCall.apply(this,arguments);}function muteAudio(){return _muteAudio.apply(this,arguments);}function _muteAudio(){_muteAudio=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(rtc.localAudioTrack){_context4.next=2;break;}return _context4.abrupt(\"return\");case 2:if(!(localTrackState.audioTrackEnabled==true)){_context4.next=10;break;}_context4.next=5;return rtc.localAudioTrack.setEnabled(false);case 5:localTrackState.audioTrackEnabled=false;$(\"#mute-audio\").hide();$(\"#unmute-audio\").show();_context4.next=15;break;case 10:_context4.next=12;return rtc.localAudioTrack.setEnabled(true);case 12:localTrackState.audioTrackEnabled=true;$(\"#mute-audio\").show();$(\"#unmute-audio\").hide();case 15:case\"end\":return _context4.stop();}}},_callee4);}));return _muteAudio.apply(this,arguments);}console.log(props.isOwner);return/*#__PURE__*/React.createElement(\"div\",{className:\"agora-card\"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Col,{sm:12,xs:12,md:4},/*#__PURE__*/React.createElement(\"div\",{id:\"local-player\",style:{width:\"280px\",height:\"400px\"}},/*#__PURE__*/React.createElement(\"img\",{style:{width:\"280px\",height:\"400px\"},src:props.audioCallData.model_picture}))),/*#__PURE__*/React.createElement(Col,{sm:12,xs:12,md:8},/*#__PURE__*/React.createElement(\"div\",{id:\"remote-playerlist\",style:{width:\"825px\",height:\"400px\"}},/*#__PURE__*/React.createElement(\"img\",{style:{width:\"825px\",height:\"400px\",objectFit:\"contain\"},src:props.audioCallData.user_picture})))),/*#__PURE__*/React.createElement(\"div\",{className:\"button-group mt-3 mb-3\"},/*#__PURE__*/React.createElement(Col,{sm:12,xs:12,md:3},props.isOwner?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"live-action-icon-sec\"},/*#__PURE__*/React.createElement(\"ul\",{className:\"list-unstyled live-action-flex\"},/*#__PURE__*/React.createElement(Media,{as:\"li\"},/*#__PURE__*/React.createElement(Link,{to:\"#\",onClick:function onClick(){return leaveCall(props.isOwner);}},/*#__PURE__*/React.createElement(Image,{src:window.location.origin+\"/assets/images/icons/end-stream.png\",className:\"action-live-icon\"}))),/*#__PURE__*/React.createElement(Media,{as:\"li\",id:\"mute-audio\"},/*#__PURE__*/React.createElement(Link,{to:\"#\",onClick:function onClick(){return muteAudio();}},/*#__PURE__*/React.createElement(Image,{src:window.location.origin+\"/assets/images/icons/audio.png\",className:\"action-live-icon\"}))),/*#__PURE__*/React.createElement(Media,{as:\"li\",id:\"unmute-audio\",style:{display:\"none\"}},/*#__PURE__*/React.createElement(Link,{to:\"#\",onClick:function onClick(){return muteAudio();}},/*#__PURE__*/React.createElement(Image,{src:window.location.origin+\"/assets/images/icons/no-audio.png\",className:\"action-live-icon\"})))))):/*#__PURE__*/React.createElement(\"div\",{className:\"live-action-icon-sec\"},/*#__PURE__*/React.createElement(\"ul\",{className:\"list-unstyled live-action-flex\"},/*#__PURE__*/React.createElement(Media,{as:\"li\"},/*#__PURE__*/React.createElement(Link,{to:\"#\",onClick:function onClick(){return leaveCall(props.isOwner);}},/*#__PURE__*/React.createElement(Image,{src:window.location.origin+\"/assets/images/icons/end-stream.png\",className:\"action-live-icon\"}))))))));};var mapStateToPros=function mapStateToPros(state){return{};};function mapDispatchToProps(dispatch){return{dispatch:dispatch};}export default connect(mapStateToPros,mapDispatchToProps)(translate(AgoraOnetoOneAudioCall));","map":{"version":3,"sources":["/home/codegama/bhawya/source_code/fx-frontend-base/src/components/Sample/AgoraOnetoOneAudioCall.jsx"],"names":["React","useEffect","useState","connect","translate","t","AgoraRTC","Form","Button","Container","Row","Col","Table","Media","Image","endAudioCallStart","joinAudioCallStart","configuration","Link","client","createClient","mode","codec","$","window","AgoraOnetoOneAudioCall","props","rtc","localAudioTrack","localTracks","audioTrack","localTrackState","audioTrackEnabled","options","appId","get","channel","token","uid","remoteUsers","startBasicCall","on","handleUserPublished","handleUserUnpublished","Promise","join","createMicrophoneAudioTrack","all","publish","console","log","dispatch","audio_call_request_id","audioCallData","subscribe","user","mediaType","play","id","leaveCall","is_owner","close","leave","location","assign","muteAudio","setEnabled","hide","show","isOwner","width","height","model_picture","objectFit","user_picture","origin","display","mapStateToPros","state","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport { translate, t } from \"react-multi-lang\";\nimport AgoraRTC from \"agora-rtc-sdk-ng\";\nimport { Form, Button, Container, Row, Col,Table,Media, Image  } from \"react-bootstrap\";\nimport {\n    endAudioCallStart,\n    joinAudioCallStart,\n  } from \"../../store/actions/PrivateCallAction\";\nimport configuration from \"react-global-configuration\";\nimport { Link } from \"react-router-dom\";\n\nconst client = AgoraRTC.createClient({ mode: \"live\", codec: \"vp8\" });\nconst $ = window.$;\n\nconst AgoraOnetoOneAudioCall = (props) => {\n\n    var rtc = {\n        // For the local client.\n        client: null,\n        // For the local audio and video tracks.\n        localAudioTrack: null,\n        // localVideoTrack: null,\n    };\n      \n\n    var localTracks = {\n        audioTrack: null\n    };\n\n    var localTrackState = {\n        audioTrackEnabled: true\n    }\n\n    var options = {\n        // Pass your app ID here.\n        appId: configuration.get(\"configData.agora_app_id\"),\n        // Set the channel name.\n        channel: \"demo_channel_name\",\n        // Pass a token if your project enables the App Certificate.\n        token: null,\n        uid: null,\n    };\n    \n    var remoteUsers = {};\n\n    async function startBasicCall() {\n\n        // Create an AgoraRTCClient object.\n        rtc.client = AgoraRTC.createClient({ mode: \"rtc\", codec: \"vp8\" });\n\n        rtc.client.on(\"user-published\", handleUserPublished);\n        rtc.client.on(\"user-unpublished\", handleUserUnpublished);\n\n        [options.uid, localTracks.audioTrack ] = await Promise.all([\n            // join the channel\n            await rtc.client.join(options.appId, options.channel, options.token, null),\n            // create local tracks, using microphone and camera\n            rtc.localAudioTrack = await AgoraRTC.createMicrophoneAudioTrack()\n        ]);\n\n        await rtc.client.publish([rtc.localAudioTrack]);\n\n        console.log(\"publish success!\");\n\n        props.dispatch(\n            joinAudioCallStart({\n                audio_call_request_id:props.audioCallData.audio_call_request_id,\n            })\n        );\n\n\n    }\n\n    async function subscribe(user, mediaType) {\n        const uid = user.uid;\n        // subscribe to a remote user\n        await rtc.client.subscribe(user, mediaType);\n        console.log(\"subscribe success\");\n        if (mediaType === 'audio') {\n          user.audioTrack.play();\n        }\n    }\n\n    function handleUserPublished(user, mediaType) {\n        const id = user.uid;\n        remoteUsers[id] = user;\n        subscribe(user, mediaType);\n    }\n      \n    function handleUserUnpublished(user) {\n        // const id = user.uid;\n        // delete remoteUsers[id];\n        // $(`#player-wrapper-${id}`).remove();\n    }\n\n      \n    startBasicCall();\n\n    async function leaveCall(is_owner) {\n\n        if (is_owner) {\n          // Destroy the local audio track.\n          rtc.localAudioTrack.close();\n\n          // Leave the channel.\n          await rtc.client.leave();\n          props.dispatch(\n            endAudioCallStart({\n                audio_call_request_id:props.audioCallData.audio_call_request_id,\n            })\n          );\n        } else {\n          // Leave the channel.\n          await rtc.client.leave();\n        } \n        \n        window.location.assign(\"/audio-calls-history\");\n      }\n  \n      async function muteAudio() {\n        if (!rtc.localAudioTrack) return;\n        if(localTrackState.audioTrackEnabled == true) {\n            await rtc.localAudioTrack.setEnabled(false);\n            localTrackState.audioTrackEnabled = false;\n            $(\"#mute-audio\").hide();\n            $(\"#unmute-audio\").show();\n        } else {\n            await rtc.localAudioTrack.setEnabled(true);\n            localTrackState.audioTrackEnabled = true;\n            $(\"#mute-audio\").show();\n            $(\"#unmute-audio\").hide();\n        }\n      }\n      \n      console.log(props.isOwner);\n    return (\n        <div className=\"agora-card\">\n            <div>\n                <Col sm={12} xs={12} md={4}>\n\n                    <div id=\"local-player\" style={{ width: \"280px\", height: \"400px\" }}>\n                        <img style={{ width: \"280px\", height: \"400px\" }} src={props.audioCallData.model_picture}/>\n                    </div>\n                </Col>\n                <Col sm={12} xs={12} md={8}>\n                    <div id=\"remote-playerlist\" style={{ width: \"825px\", height: \"400px\" }}>\n                        <img style={{ width: \"825px\", height: \"400px\", objectFit: \"contain\" }} src={props.audioCallData.user_picture}/>\n                    </div>\n                </Col>\n            </div>\n            <div className=\"button-group mt-3 mb-3\">\n                <Col sm={12} xs={12} md={3}>\n\n                {props.isOwner ? \n                    <>\n                    <div className=\"live-action-icon-sec\">\n                        <ul className=\"list-unstyled live-action-flex\">\n                            <Media as=\"li\">\n                                <Link to=\"#\" \n                                    onClick={() =>\n                                    leaveCall(props.isOwner)\n                                }>\n                                    <Image\n                                    src={\n                                        window.location.origin + \"/assets/images/icons/end-stream.png\"\n                                    }\n                                    className=\"action-live-icon\"\n                                    />\n                                </Link>\n                            </Media>\n                            <Media as=\"li\" id=\"mute-audio\">\n                                <Link to=\"#\"\n                                onClick={() =>\n                                    muteAudio()\n                                }>\n                                    <Image\n                                    src={\n                                        window.location.origin + \"/assets/images/icons/audio.png\"\n                                    }\n                                    className=\"action-live-icon\"\n                                    />\n                                </Link>\n                            </Media>\n                            <Media as=\"li\" id=\"unmute-audio\" style={{display: \"none\"}}>\n                                <Link to=\"#\"\n                                onClick={() =>\n                                    muteAudio()\n                                }>\n                                    <Image\n                                    src={\n                                        window.location.origin + \"/assets/images/icons/no-audio.png\"\n                                    }\n                                    className=\"action-live-icon\"\n                                    />\n                                </Link>\n                            </Media>\n                        </ul>\n                    </div>\n                    </>\n                :\n                    <div className=\"live-action-icon-sec\">\n                        <ul className=\"list-unstyled live-action-flex\">\n                            <Media as=\"li\">\n                                <Link to=\"#\" \n                                    onClick={() =>\n                                    leaveCall(props.isOwner)\n                                }>\n                                    <Image\n                                    src={\n                                        window.location.origin + \"/assets/images/icons/end-stream.png\"\n                                    }\n                                    className=\"action-live-icon\"\n                                    />\n                                </Link>\n                            </Media>\n                        </ul>\n                    </div>\n                }\n\n                </Col>\n            </div>\n        </div>\n        \n    );\n};\n\n\nconst mapStateToPros = (state) => ({\n  \n});\n\nfunction mapDispatchToProps(dispatch) {\nreturn { dispatch };\n}\n\nexport default connect(mapStateToPros, mapDispatchToProps)(translate(AgoraOnetoOneAudioCall));"]},"metadata":{},"sourceType":"module"}