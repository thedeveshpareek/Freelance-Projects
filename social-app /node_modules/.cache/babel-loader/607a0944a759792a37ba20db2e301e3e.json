{"ast":null,"code":"import _slicedToArray from\"/home/codegama/bhawya/source_code/fx-frontend-base/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";var _this=this;import React,{useState,useEffect}from\"react\";import{Form,Button,Image,Modal,Tab,Nav,Row,Col}from\"react-bootstrap\";import{connect}from\"react-redux\";import{PPVPaymentStripeStart,PPVPaymentWalletStart,PPVPaymentPaypalStart,PPVPaymentCCBillStart,PPVPaymentCoinPaymentStart}from\"../../store/actions/PostAction\";import{fetchCardDetailsStart}from\"../../store/actions/CardsAction\";import{fetchWalletDetailsStart}from\"../../store/actions/WalletAction\";import PaypalExpressBtn from\"react-paypal-express-checkout\";import{createNotification}from\"react-redux-notify\";import{getSuccessNotificationMessage,getErrorNotificationMessage}from\"../../components/helper/NotificationMessage\";import configuration from\"react-global-configuration\";import{Link}from\"react-router-dom\";import{translate,t}from\"react-multi-lang\";var PPVPaymentModal=function PPVPaymentModal(props){var _useState=useState(0),_useState2=_slicedToArray(_useState,2),amount=_useState2[0],setAmount=_useState2[1];var _useState3=useState(localStorage.getItem(\"default_payment_method\")),_useState4=_slicedToArray(_useState3,2),paymentType=_useState4[0],setPaymentType=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),showPayPal=_useState6[0],payPal=_useState6[1];useEffect(function(){if(props.PPVPayment===true){props.dispatch(fetchCardDetailsStart());props.dispatch(fetchWalletDetailsStart());}},[props.PPVPayment]);var handleSubmit=function handleSubmit(event){event.preventDefault();if(paymentType===\"PAYPAL\")showPayPal(true);if(paymentType===\"CARD\")props.dispatch(PPVPaymentStripeStart({post_id:props.post_id!=undefined||props.post_id!=null?props.post_id:\"\",amount:amount,user_id:props.user_id}));if(paymentType===\"WALLET\")props.dispatch(PPVPaymentWalletStart({post_id:props.post_id!=undefined||props.post_id!=null?props.post_id:\"\",user_id:props.user_id}));if(paymentType===\"CCBILL\")props.dispatch(PPVPaymentCCBillStart({post_id:props.post_id!=undefined||props.post_id!=null?props.post_id:\"\",amount:props.amount,user_id:props.user_id}));if(paymentType===\"coinpayment\")props.dispatch(PPVPaymentCoinPaymentStart({post_id:props.post_id!=undefined||props.post_id!=null?props.post_id:\"\",amount:props.amount,user_id:props.user_id}));if(paymentType===\"PAYPAL\")props.closePPVPaymentModal();};var paypalOnSuccess=function paypalOnSuccess(payment){console.log(payment);setTimeout(function(){props.dispatch(PPVPaymentPaypalStart({payment_id:payment.paymentID,post_id:props.post_id!=undefined||props.post_id!=null?props.post_id:\"\",amount:props.amount,user_id:props.user_id}));},1000);};var paypalOnError=function paypalOnError(err){var notificationMessage=getErrorNotificationMessage(err);_this.props.dispatch(createNotification(notificationMessage));};var paypalOnCancel=function paypalOnCancel(data){var notificationMessage=getErrorNotificationMessage(\"Payment cancelled please try again..\");_this.props.dispatch(createNotification(notificationMessage));};var choosePaymentOption=function choosePaymentOption(event){console.log(amount);setPaymentType(event);};var env=configuration.get(\"configData.PAYPAL_MODE\");// you can set here to 'production' for production\nvar currency=\"USD\";// or you can set this value from your props or state\nvar client={sandbox:configuration.get(\"configData.PAYPAL_ID\"),production:configuration.get(\"configData.PAYPAL_ID\")};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Modal,{show:props.PPVPayment,onHide:props.closePPVPaymentModal,centered:true,size:\"lg\"},props.PPVPayment===true?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Modal.Header,{closeButton:true},/*#__PURE__*/React.createElement(Modal.Title,null,t(\"pay_and_see_the_Post\"))),/*#__PURE__*/React.createElement(Modal.Body,{className:\"subscription-tip-ppv-tab\"},/*#__PURE__*/React.createElement(Tab.Container,{id:\"left-tabs-example\",defaultActiveKey:paymentType},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{sm:3},/*#__PURE__*/React.createElement(Nav,{variant:\"pills\",className:\"flex-column\"},configuration.get(\"configData.is_stripe_enabled\")==1&&configuration.get(\"configData.stripe_publishable_key\")!==\"\"&&configuration.get(\"configData.stripe_secret_key\")!==\"\"?/*#__PURE__*/React.createElement(Nav.Item,null,/*#__PURE__*/React.createElement(Nav.Link,{onClick:function onClick(){return setPaymentType(\"CARD\");},eventKey:\"CARD\"},t(\"card_stripe\"))):null,configuration.get(\"configData.is_paypal_enabled\")==1&&configuration.get(\"configData.PAYPAL_ID\")!==\"\"?/*#__PURE__*/React.createElement(Nav.Item,null,/*#__PURE__*/React.createElement(Nav.Link,{onClick:function onClick(){return setPaymentType(\"PAYPAL\");},eventKey:\"PAYPAL\"},t(\"paypal\"))):null,configuration.get(\"configData.is_ccbill_enabled\")==1&&configuration.get(\"configData.flex_form_id\")!==\"\"&&configuration.get(\"configData.salt_key\")!==\"\"?/*#__PURE__*/React.createElement(Nav.Item,null,/*#__PURE__*/React.createElement(Nav.Link,{onClick:function onClick(){return setPaymentType(\"CCBILL\");},eventKey:\"CCBILL\"},t(\"ccbill\"))):null,configuration.get(\"configData.is_wallet_payment_enabled\")==1?/*#__PURE__*/React.createElement(Nav.Item,null,/*#__PURE__*/React.createElement(Nav.Link,{onClick:function onClick(){return setPaymentType(\"WALLET\");},eventKey:\"WALLET\"},t(\"wallet\"))):null)),/*#__PURE__*/React.createElement(Col,{sm:9},/*#__PURE__*/React.createElement(\"div\",{className:\"card-stripe-box\"},/*#__PURE__*/React.createElement(Form,null,/*#__PURE__*/React.createElement(Form.Group,{className:\"mb-3\",controlId:\"exampleForm.ControlInput1\"},/*#__PURE__*/React.createElement(Form.Control,{type:\"text\",placeholder:t(\"pay_amount\"),value:props.post.amount_formatted,disabled:true})),/*#__PURE__*/React.createElement(Tab.Content,null,configuration.get(\"configData.is_stripe_enabled\")==1&&configuration.get(\"configData.stripe_publishable_key\")!==\"\"&&configuration.get(\"configData.stripe_secret_key\")!==\"\"?/*#__PURE__*/React.createElement(Tab.Pane,{eventKey:\"CARD\"},/*#__PURE__*/React.createElement(\"div\",{className:\"card-stripe-sec\"},props.cards.loading?\"\":props.cards.data.cards.length>0?props.cards.data.cards.map(function(card){return card.is_default==1&&/*#__PURE__*/React.createElement(\"div\",{className:\"card-stripe-list-box\"},/*#__PURE__*/React.createElement(\"h5\",{className:\"mb-3\"},\"XXXX XXXX XXXX \",card.last_four),/*#__PURE__*/React.createElement(\"h5\",{className:\"text-muted\"},card.card_type),/*#__PURE__*/React.createElement(\"div\",{className:\"card-stripe-bottom\"},/*#__PURE__*/React.createElement(\"div\",{className:\"card-stripe-action-btn\"},/*#__PURE__*/React.createElement(\"p\",{className:\"card-link-text text-success\"},t(\"default_card\")))));}):/*#__PURE__*/React.createElement(\"div\",{className:\"card-stripe-item\"},/*#__PURE__*/React.createElement(Link,{to:\"cards\"},/*#__PURE__*/React.createElement(\"div\",{className:\"add-account-item\"},/*#__PURE__*/React.createElement(Image,{className:\"add-account-icon\",src:window.location.origin+\"/assets/images/icons/new/add-card.svg\"}),/*#__PURE__*/React.createElement(\"h5\",{className:\"text-muted\"},\"Add Card\")))))):null,configuration.get(\"configData.is_wallet_payment_enabled\")==1?/*#__PURE__*/React.createElement(Tab.Pane,{eventKey:\"WALLET\"},props.wallet.loading?\"\":/*#__PURE__*/React.createElement(\"div\",{className:\"card-stripe-box\"},/*#__PURE__*/React.createElement(\"div\",{className:\"wallet-balence-amount\"},/*#__PURE__*/React.createElement(\"h4\",null,t(\"available\")),/*#__PURE__*/React.createElement(\"p\",null,props.wallet.data.user_wallet.remaining_formatted)),props.amount>props.wallet.data.user_wallet.remaining?/*#__PURE__*/React.createElement(\"div\",{className:\"\"},/*#__PURE__*/React.createElement(\"p\",{className:\"conv-desc desc\"},t(\"low_wallet_balance_tips_payment_para\")),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex\"},/*#__PURE__*/React.createElement(Link,{to:\"/wallet\",className:\"withdraw-money-btn\"},t(\"add_wallet_amount\")))):null)):null))))))),/*#__PURE__*/React.createElement(Modal.Footer,null,paymentType===\"PAYPAL\"&&props.amount!=0?/*#__PURE__*/React.createElement(PaypalExpressBtn,{env:env,client:client,currency:currency,total:props.amount,onError:paypalOnError,onSuccess:paypalOnSuccess,onCancel:paypalOnCancel}):null,/*#__PURE__*/React.createElement(Button,{type:\"button\",className:\"btn btn-danger\",\"data-dismiss\":\"modal\",onClick:props.closePPVPaymentModal},t(\"cancel\")),paymentType!==\"PAYPAL\"?/*#__PURE__*/React.createElement(Button,{type:\"button\",className:\"btn btn-success\",\"data-dismiss\":\"modal\",onClick:handleSubmit,disabled:props.ppvPayStripe.buttonDisable},props.ppvPayStripe.loadingButtonContent!==null?props.ppvPayStripe.loadingButtonContent:t(\"pay_now\")):null)):null));};var mapStateToPros=function mapStateToPros(state){return{ppvPayStripe:state.post.ppvPayStripe,wallet:state.wallet.walletData,cards:state.cards.cardDetails};};function mapDispatchToProps(dispatch){return{dispatch:dispatch};}export default connect(mapStateToPros,mapDispatchToProps)(translate(PPVPaymentModal));","map":{"version":3,"sources":["/home/codegama/bhawya/source_code/fx-frontend-base/src/components/helper/PPVPaymentModal.jsx"],"names":["React","useState","useEffect","Form","Button","Image","Modal","Tab","Nav","Row","Col","connect","PPVPaymentStripeStart","PPVPaymentWalletStart","PPVPaymentPaypalStart","PPVPaymentCCBillStart","PPVPaymentCoinPaymentStart","fetchCardDetailsStart","fetchWalletDetailsStart","PaypalExpressBtn","createNotification","getSuccessNotificationMessage","getErrorNotificationMessage","configuration","Link","translate","t","PPVPaymentModal","props","amount","setAmount","localStorage","getItem","paymentType","setPaymentType","showPayPal","payPal","PPVPayment","dispatch","handleSubmit","event","preventDefault","post_id","undefined","user_id","closePPVPaymentModal","paypalOnSuccess","payment","console","log","setTimeout","payment_id","paymentID","paypalOnError","err","notificationMessage","paypalOnCancel","data","choosePaymentOption","env","get","currency","client","sandbox","production","post","amount_formatted","cards","loading","length","map","card","is_default","last_four","card_type","window","location","origin","wallet","user_wallet","remaining_formatted","remaining","ppvPayStripe","buttonDisable","loadingButtonContent","mapStateToPros","state","walletData","cardDetails","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport {\n  Form,\n  Button,\n  Image,\n  Modal,\n  Tab,\n  Nav,\n  Row,\n  Col,\n} from \"react-bootstrap\";\nimport { connect } from \"react-redux\";\nimport {\n  PPVPaymentStripeStart,\n  PPVPaymentWalletStart,\n  PPVPaymentPaypalStart,\n  PPVPaymentCCBillStart,\n  PPVPaymentCoinPaymentStart,\n} from \"../../store/actions/PostAction\";\nimport { fetchCardDetailsStart } from \"../../store/actions/CardsAction\";\nimport { fetchWalletDetailsStart } from \"../../store/actions/WalletAction\";\nimport PaypalExpressBtn from \"react-paypal-express-checkout\";\nimport { createNotification } from \"react-redux-notify\";\nimport {\n  getSuccessNotificationMessage,\n  getErrorNotificationMessage,\n} from \"../../components/helper/NotificationMessage\";\nimport configuration from \"react-global-configuration\";\nimport { Link } from \"react-router-dom\";\nimport { translate, t } from \"react-multi-lang\";\n\nconst PPVPaymentModal = (props) => {\n  const [amount, setAmount] = useState(0);\n  const [paymentType, setPaymentType] = useState(\n    localStorage.getItem(\"default_payment_method\")\n  );\n\n  const [showPayPal, payPal] = useState(false);\n\n  useEffect(() => {\n    if (props.PPVPayment === true) {\n      props.dispatch(fetchCardDetailsStart());\n      props.dispatch(fetchWalletDetailsStart());\n    }\n  }, [props.PPVPayment]);\n\n  const handleSubmit = (event) => {\n    event.preventDefault();\n    if (paymentType === \"PAYPAL\") showPayPal(true);\n\n    if (paymentType === \"CARD\")\n      props.dispatch(\n        PPVPaymentStripeStart({\n          post_id:\n            props.post_id != undefined || props.post_id != null\n              ? props.post_id\n              : \"\",\n          amount: amount,\n          user_id: props.user_id,\n        })\n      );\n    if (paymentType === \"WALLET\")\n      props.dispatch(\n        PPVPaymentWalletStart({\n          post_id:\n            props.post_id != undefined || props.post_id != null\n              ? props.post_id\n              : \"\",\n          user_id: props.user_id,\n        })\n      );\n    if (paymentType === \"CCBILL\")\n      props.dispatch(\n        PPVPaymentCCBillStart({\n          post_id:\n            props.post_id != undefined || props.post_id != null\n              ? props.post_id\n              : \"\",\n          amount: props.amount,\n          user_id: props.user_id,\n        })\n      );\n    if (paymentType === \"coinpayment\")\n      props.dispatch(\n        PPVPaymentCoinPaymentStart({\n          post_id:\n            props.post_id != undefined || props.post_id != null\n              ? props.post_id\n              : \"\",\n          amount: props.amount,\n          user_id: props.user_id,\n        })\n      );\n\n    if (paymentType === \"PAYPAL\") props.closePPVPaymentModal();\n  };\n\n  const paypalOnSuccess = (payment) => {\n    console.log(payment);\n    setTimeout(() => {\n      props.dispatch(\n        PPVPaymentPaypalStart({\n          payment_id: payment.paymentID,\n          post_id:\n            props.post_id != undefined || props.post_id != null\n              ? props.post_id\n              : \"\",\n          amount: props.amount,\n          user_id: props.user_id,\n        })\n      );\n    }, 1000);\n  };\n\n  const paypalOnError = (err) => {\n    const notificationMessage = getErrorNotificationMessage(err);\n    this.props.dispatch(createNotification(notificationMessage));\n  };\n\n  const paypalOnCancel = (data) => {\n    const notificationMessage = getErrorNotificationMessage(\n      \"Payment cancelled please try again..\"\n    );\n    this.props.dispatch(createNotification(notificationMessage));\n  };\n\n  const choosePaymentOption = (event) => {\n    console.log(amount);\n    setPaymentType(event);\n  };\n\n  let env = configuration.get(\"configData.PAYPAL_MODE\"); // you can set here to 'production' for production\n  let currency = \"USD\"; // or you can set this value from your props or state\n\n  const client = {\n    sandbox: configuration.get(\"configData.PAYPAL_ID\"),\n    production: configuration.get(\"configData.PAYPAL_ID\"),\n  };\n\n  return (\n    <>\n      <Modal\n        show={props.PPVPayment}\n        onHide={props.closePPVPaymentModal}\n        centered\n        size=\"lg\"\n      >\n        {props.PPVPayment === true ? (\n          <>\n            <Modal.Header closeButton>\n              <Modal.Title>{t(\"pay_and_see_the_Post\")}</Modal.Title>\n            </Modal.Header>\n            <Modal.Body className=\"subscription-tip-ppv-tab\">\n              <Tab.Container\n                id=\"left-tabs-example\"\n                defaultActiveKey={paymentType}\n              >\n                <Row>\n                  <Col sm={3}>\n                    <Nav variant=\"pills\" className=\"flex-column\">\n                      {configuration.get(\"configData.is_stripe_enabled\") == 1 &&\n                      configuration.get(\"configData.stripe_publishable_key\") !==\n                        \"\" &&\n                      configuration.get(\"configData.stripe_secret_key\") !==\n                        \"\" ? (\n                        <Nav.Item>\n                          <Nav.Link\n                            onClick={() => setPaymentType(\"CARD\")}\n                            eventKey=\"CARD\"\n                          >\n                            {t(\"card_stripe\")}\n                          </Nav.Link>\n                        </Nav.Item>\n                      ) : null}\n                      {configuration.get(\"configData.is_paypal_enabled\") == 1 &&\n                      configuration.get(\"configData.PAYPAL_ID\") !== \"\" ? (\n                        <Nav.Item>\n                          <Nav.Link\n                            onClick={() => setPaymentType(\"PAYPAL\")}\n                            eventKey=\"PAYPAL\"\n                          >\n                            {t(\"paypal\")}\n                          </Nav.Link>\n                        </Nav.Item>\n                      ) : null}\n                      {configuration.get(\"configData.is_ccbill_enabled\") == 1 &&\n                      configuration.get(\"configData.flex_form_id\") !== \"\" &&\n                      configuration.get(\"configData.salt_key\") !== \"\" ? (\n                        <Nav.Item>\n                          <Nav.Link\n                            onClick={() => setPaymentType(\"CCBILL\")}\n                            eventKey=\"CCBILL\"\n                          >\n                            {t(\"ccbill\")}\n                          </Nav.Link>\n                        </Nav.Item>\n                      ) : null}\n                      {configuration.get(\n                        \"configData.is_wallet_payment_enabled\"\n                      ) == 1 ? (\n                        <Nav.Item>\n                          <Nav.Link\n                            onClick={() => setPaymentType(\"WALLET\")}\n                            eventKey=\"WALLET\"\n                          >\n                            {t(\"wallet\")}\n                          </Nav.Link>\n                        </Nav.Item>\n                      ) : null}\n                    </Nav>\n                  </Col>\n                  <Col sm={9}>\n                    <div className=\"card-stripe-box\">\n                      <Form>\n                        <Form.Group\n                          className=\"mb-3\"\n                          controlId=\"exampleForm.ControlInput1\"\n                        >\n                          <Form.Control\n                            type=\"text\"\n                            placeholder={t(\"pay_amount\")}\n                            value={props.post.amount_formatted}\n                            disabled\n                          />\n                        </Form.Group>\n                        <Tab.Content>\n                          {configuration.get(\"configData.is_stripe_enabled\") ==\n                            1 &&\n                          configuration.get(\n                            \"configData.stripe_publishable_key\"\n                          ) !== \"\" &&\n                          configuration.get(\"configData.stripe_secret_key\") !==\n                            \"\" ? (\n                            <Tab.Pane eventKey=\"CARD\">\n                              <div className=\"card-stripe-sec\">\n                                {props.cards.loading ? (\n                                  \"\"\n                                ) : props.cards.data.cards.length > 0 ? (\n                                  props.cards.data.cards.map(\n                                    (card) =>\n                                      card.is_default == 1 && (\n                                        <div className=\"card-stripe-list-box\">\n                                          <h5 className=\"mb-3\">\n                                            XXXX XXXX XXXX {card.last_four}\n                                          </h5>\n                                          <h5 className=\"text-muted\">\n                                            {card.card_type}\n                                          </h5>\n                                          <div className=\"card-stripe-bottom\">\n                                            <div className=\"card-stripe-action-btn\">\n                                              <p className=\"card-link-text text-success\">\n                                                {t(\"default_card\")}\n                                              </p>\n                                            </div>\n                                          </div>\n                                        </div>\n                                      )\n                                  )\n                                ) : (\n                                  <div className=\"card-stripe-item\">\n                                    <Link to=\"cards\">\n                                      <div className=\"add-account-item\">\n                                        <Image\n                                          className=\"add-account-icon\"\n                                          src={\n                                            window.location.origin +\n                                            \"/assets/images/icons/new/add-card.svg\"\n                                          }\n                                        />\n                                        <h5 className=\"text-muted\">Add Card</h5>\n                                      </div>\n                                    </Link>\n                                  </div>\n                                )}\n                              </div>\n                            </Tab.Pane>\n                          ) : null}\n\n                          {configuration.get(\n                            \"configData.is_wallet_payment_enabled\"\n                          ) == 1 ? (\n                            <Tab.Pane eventKey=\"WALLET\">\n                              {props.wallet.loading ? (\n                                \"\"\n                              ) : (\n                                <div className=\"card-stripe-box\">\n                                  <div className=\"wallet-balence-amount\">\n                                    <h4>{t(\"available\")}</h4>\n                                    <p>\n                                      {\n                                        props.wallet.data.user_wallet\n                                          .remaining_formatted\n                                      }\n                                    </p>\n                                  </div>\n                                  {props.amount >\n                                  props.wallet.data.user_wallet.remaining ? (\n                                    <div className=\"\">\n                                      <p className=\"conv-desc desc\">\n                                        {t(\n                                          \"low_wallet_balance_tips_payment_para\"\n                                        )}\n                                      </p>\n                                      <div className=\"d-flex\">\n                                        <Link\n                                          to=\"/wallet\"\n                                          className=\"withdraw-money-btn\"\n                                        >\n                                          {t(\"add_wallet_amount\")}\n                                        </Link>\n                                      </div>\n                                    </div>\n                                  ) : null}\n                                </div>\n                              )}\n                            </Tab.Pane>\n                          ) : null}\n                        </Tab.Content>\n                      </Form>\n                    </div>\n                  </Col>\n                </Row>\n              </Tab.Container>\n            </Modal.Body>\n            <Modal.Footer>\n              {paymentType === \"PAYPAL\" && props.amount != 0 ? (\n                <PaypalExpressBtn\n                  env={env}\n                  client={client}\n                  currency={currency}\n                  total={props.amount}\n                  onError={paypalOnError}\n                  onSuccess={paypalOnSuccess}\n                  onCancel={paypalOnCancel}\n                />\n              ) : null}\n              <Button\n                type=\"button\"\n                className=\"btn btn-danger\"\n                data-dismiss=\"modal\"\n                onClick={props.closePPVPaymentModal}\n              >\n                {t(\"cancel\")}\n              </Button>\n              {paymentType !== \"PAYPAL\" ? (\n                <Button\n                  type=\"button\"\n                  className=\"btn btn-success\"\n                  data-dismiss=\"modal\"\n                  onClick={handleSubmit}\n                  disabled={props.ppvPayStripe.buttonDisable}\n                >\n                  {props.ppvPayStripe.loadingButtonContent !== null\n                    ? props.ppvPayStripe.loadingButtonContent\n                    : t(\"pay_now\")}\n                </Button>\n              ) : null}\n            </Modal.Footer>\n          </>\n        ) : null}\n      </Modal>\n    </>\n  );\n};\n\nconst mapStateToPros = (state) => ({\n  ppvPayStripe: state.post.ppvPayStripe,\n  wallet: state.wallet.walletData,\n  cards: state.cards.cardDetails,\n});\n\nfunction mapDispatchToProps(dispatch) {\n  return { dispatch };\n}\n\nexport default connect(\n  mapStateToPros,\n  mapDispatchToProps\n)(translate(PPVPaymentModal));\n"]},"metadata":{},"sourceType":"module"}