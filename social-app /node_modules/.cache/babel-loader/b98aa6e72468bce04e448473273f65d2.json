{"ast":null,"code":"import _objectSpread from\"/home/codegama/bhawya/source_code/fx-frontend-base/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"/home/codegama/bhawya/source_code/fx-frontend-base/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/home/codegama/bhawya/source_code/fx-frontend-base/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState,useRef}from\"react\";import{Link}from\"react-router-dom\";import{Form,Button,Container,Row,Col,Dropdown,Image,Media,InputGroup,FormControl,Modal,Tab,Nav}from\"react-bootstrap\";import{connect}from\"react-redux\";import{addMessageContent,fetchChatMessageStart,fetchChatUsersStart}from\"../../store/actions/ChatAction\";import ChatUserList from\"./ChatUserList\";import InboxNoDataFound from\"../NoDataFound/InboxNoDataFound\";import io from\"socket.io-client\";import configuration from\"react-global-configuration\";import{translate,t}from\"react-multi-lang\";import InboxLoader from\"../Loader/InboxLoader\";import{getErrorNotificationMessage}from\"../helper/NotificationMessage\";import{createNotification}from\"react-redux-notify/lib/modules/Notifications\";import VerifiedBadgeNoShadow from\"../Handlers/VerifiedBadgeNoShadow\";import ChatAssetModal from\"../helper/ChatAssetModal\";import ReactPlayer from\"react-player/lazy\";import AssetPaymentModal from\"../helper/AssetPaymentModal\";var $=window.$;var chatSocket;var MessageIndex=function MessageIndex(props){var _useState=useState(0),_useState2=_slicedToArray(_useState,2),activeChat=_useState2[0],setActiveChat=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),toUserId=_useState4[0],setToUserId=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),inputMessage=_useState6[0],setInputMessage=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),initialHeight=_useState8[0],setInitialHeight=_useState8[1];var messageRef=useRef();useEffect(function(){props.dispatch(fetchChatUsersStart());var chatSocketUrl=configuration.get(\"configData.chat_socket_url\");if(chatSocketUrl===\"\"){var notificationMessage=getErrorNotificationMessage(\"Socket URL is not configured. Chat wil not work...\");props.dispatch(createNotification(notificationMessage));window.location.assign(\"/home\");}if(messageRef.current){messageRef.current.scrollIntoView({behavior:\"smooth\",block:\"end\",inline:\"nearest\"});}},[]);useEffect(function(){if(props.chatUsers.loading===false&&props.chatUsers.data.users.length>0){console.log(\"Number of times called true  \");setToUserId(props.chatUsers.data.users[0].to_user_id);chatSocketConnect(props.chatUsers.data.users[0].to_user_id);}else{}},[!props.chatUsers.loading]);// Scroll down function..\nuseEffect(function(){console.log(\"Scroll down..\");var objDiv=document.getElementById(\"options-holder\");if(objDiv!=null){var differenceNumber=objDiv.offsetHeight>objDiv.scrollHeight?objDiv.offsetHeight-objDiv.scrollHeight:objDiv.scrollHeight-objDiv.offsetHeight;if(differenceNumber>280){objDiv.scrollTop=objDiv.scrollHeight;}else{objDiv.scrollTop=initialHeight;setInitialHeight(initialHeight+20);}}},[props.chatMessages.data.messages]);var chatSocketConnect=function chatSocketConnect(to_user_id){// check the socket url is configured\nvar chatSocketUrl=configuration.get(\"configData.chat_socket_url\");console.log(\"chatSocket\",chatSocketUrl);console.log(\"Input ID\",to_user_id);if(chatSocketUrl){chatSocket=io(chatSocketUrl,{query:\"commonid:'user_id_\"+localStorage.getItem(\"userId\")+\"_to_user_id_\"+to_user_id+\"',myid:\"+localStorage.getItem(\"userId\")});console.log(\"chatSocket\",chatSocket);chatSocket.emit(\"update sender\",{commonid:\"user_id_\"+localStorage.getItem(\"userId\")+\"_to_user_id_\"+to_user_id,myid:localStorage.getItem(\"userId\")});var chatContent;chatSocket.on(\"message\",function(newData){var content=[];content.push(newData);// chatContent = [...this.state.chatData, ...content];\n// this.setState({ chatData: chatContent });\nconsole.log(content);props.dispatch(addMessageContent(content));});}};var changeUser=function changeUser(event,chat,index){chatSocket.disconnect();event.preventDefault();setActiveChat(index);var to_user_id=chat.to_user_id==localStorage.getItem(\"userId\")?chat.from_user_id:chat.to_user_id;setToUserId(to_user_id);props.dispatch(fetchChatMessageStart({to_user_id:chat.to_user_id,from_user_id:chat.from_user_id}));chatSocketConnect(to_user_id);};var handleChatSubmit=function handleChatSubmit(event){event.preventDefault();var chatSocketUrl=configuration.get(\"configData.chat_socket_url\");if(chatSocketUrl!=undefined&&inputMessage){var chatData=[{from_user_id:localStorage.getItem(\"userId\"),to_user_id:toUserId,message:inputMessage,type:\"uu\",user_picture:localStorage.getItem(\"user_picture\"),loggedin_user_id:localStorage.getItem(\"userId\"),created:Date(),from_username:localStorage.getItem(\"username\"),from_displayname:localStorage.getItem(\"name\"),from_userpicture:localStorage.getItem(\"user_picture\"),from_user_unique_id:\"\",to_username:\"\",to_displayname:\"\",to_userpicture:\"\",to_user_unique_id:\"\"}];chatSocket.emit(\"message\",chatData[0]);var messages;if(props.chatMessages.data.messages!=null){messages=[].concat(_toConsumableArray(props.chatMessages.data.messages),chatData);}else{messages=[].concat(chatData);}setInputMessage(\"\");props.dispatch(addMessageContent(chatData));}};var chatInputChange=function chatInputChange(value){setInputMessage(value);};var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),chatAssetUpload=_useState10[0],setChatAssetUpload=_useState10[1];var _useState11=useState(\"picture\"),_useState12=_slicedToArray(_useState11,2),fileType=_useState12[0],setFileType=_useState12[1];var closeChatAssetUploadModal=function closeChatAssetUploadModal(){setChatAssetUpload(false);};var handleAssetUploadModal=function handleAssetUploadModal(fileType){setChatAssetUpload(true);setFileType(fileType);};useEffect(function(){props.assetUpload.loading||handleMediaSubmit();},[props.assetUpload.loading]);var handleMediaSubmit=function handleMediaSubmit(){var assetData=props.assetUpload.data.chat_asset;var assetMessage=props.assetUpload.data.chat_message;var chatSocketUrl=configuration.get(\"configData.chat_socket_url\");if(chatSocketUrl!=undefined&&assetData&&assetMessage){var chatData=[{from_user_id:localStorage.getItem(\"userId\"),to_user_id:toUserId,chat_message_id:assetMessage?assetMessage.chat_message_id:\"\",message:assetMessage?assetMessage.message:\"\",type:\"uu\",user_picture:localStorage.getItem(\"user_picture\"),loggedin_user_id:localStorage.getItem(\"userId\"),created:Date(),from_username:localStorage.getItem(\"username\"),from_displayname:localStorage.getItem(\"name\"),from_userpicture:localStorage.getItem(\"user_picture\"),from_user_unique_id:\"\",to_username:\"\",to_displayname:\"\",to_userpicture:\"\",to_user_unique_id:\"\",chat_asset_id:assetData?assetData.chat_asset_id:\"\",chat_asset_url:assetMessage.amount>0?assetData.blur_file:assetData.file,file_type:assetData.file_type,is_user_needs_pay:assetMessage.amount>0?1:0,amount:assetMessage.amount>0?assetMessage.amount:0,amount_formatted:assetMessage.amount>0?assetMessage.amount_formatted:0,payment_text:assetMessage.amount>0?\"UNLOCK MESSAGE FOR \"+assetMessage.amount_formatted:\"\"}];var chatMessageData=[{from_user_id:localStorage.getItem(\"userId\"),to_user_id:toUserId,chat_message_id:assetMessage?assetMessage.chat_message_id:\"\",message:assetMessage?assetMessage.message:\"\",type:\"uu\",user_picture:localStorage.getItem(\"user_picture\"),loggedin_user_id:localStorage.getItem(\"userId\"),created:Date(),from_username:localStorage.getItem(\"username\"),from_displayname:localStorage.getItem(\"name\"),from_userpicture:localStorage.getItem(\"user_picture\"),from_user_unique_id:\"\",to_username:\"\",to_displayname:\"\",to_userpicture:\"\",to_user_unique_id:\"\",chat_asset_id:assetData?assetData.chat_asset_id:\"\",chat_asset_url:assetData.file,file_type:assetData.file_type,amount:assetMessage.amount>0?assetMessage.amount:0,amount_formatted:assetMessage.amount>0?assetMessage.amount_formatted:0,is_user_needs_pay:0,payment_text:\"\"}];chatSocket.emit(\"message\",chatData[0]);var messages;if(props.chatMessages.data.messages!=null){messages=[].concat(_toConsumableArray(props.chatMessages.data.messages),chatMessageData);}else{messages=[].concat(chatMessageData);}if(assetData){closeChatAssetUploadModal();}setInputMessage(\"\");props.dispatch(addMessageContent(chatMessageData));}};var _useState13=useState({chat_message_id:0,from_user_id:localStorage.getItem(\"userId\"),to_user_id:toUserId,amount_formatted:0,amount:0}),_useState14=_slicedToArray(_useState13,2),paymentData=_useState14[0],setPaymentData=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),chatPayment=_useState16[0],setPaymentModal=_useState16[1];var handleAssetPayment=function handleAssetPayment(event,chat_message_id,amount_formatted,amount){event.preventDefault();setPaymentData(_objectSpread(_objectSpread({},paymentData),{},{chat_message_id:chat_message_id,amount:amount,amount_formatted:amount_formatted}));setPaymentModal(true);};var closePaymentModal=function closePaymentModal(){setPaymentModal(false);};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"message-page\"},/*#__PURE__*/React.createElement(Container,null,/*#__PURE__*/React.createElement(Row,null,props.chatUsers.loading?/*#__PURE__*/React.createElement(InboxLoader,null):props.chatUsers.data.users.length>0?/*#__PURE__*/React.createElement(ChatUserList,{chatUsers:props.chatUsers.data,activeChat:activeChat,setActiveChat:setActiveChat,changeUser:changeUser}):/*#__PURE__*/React.createElement(InboxNoDataFound,null),/*#__PURE__*/React.createElement(Col,{sm:12,md:12,lg:7,xl:8,className:\"resp-mrg-btn-xs margin-col col8-sm\"},props.chatMessages.loading?\"\":/*#__PURE__*/React.createElement(Row,{className:\"msg-row-chat\"},/*#__PURE__*/React.createElement(\"div\",{className:\"msg-header\"},/*#__PURE__*/React.createElement(\"h1\",{className:\"chat-section-title\"},/*#__PURE__*/React.createElement(\"div\",{className:\"chat-section-title-width\"},/*#__PURE__*/React.createElement(Link,{to:\"/\"+props.chatMessages.data.user.user_unique_id,className:\"chat-user-name\"},props.chatMessages.data.user.name,\" \",props.chatMessages.data.user.is_verified_badge==1?/*#__PURE__*/ // <img\n//   className=\"verified-badge\"\n//   alt=\"verified-badge\"\n//   src={\n//     window.location.origin +\n//     \"/assets/images/verified.svg\"\n//   }\n// />\nReact.createElement(VerifiedBadgeNoShadow,null):null))),/*#__PURE__*/React.createElement(\"div\",{className:\"drop-down-chat-sec\"},/*#__PURE__*/React.createElement(Dropdown,null,/*#__PURE__*/React.createElement(Dropdown.Toggle,{className:\"btn btn-default dropdown-toggle btn-normal-2\",type:\"button\",id:\"dropdown-basic\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-ellipsis-v\"})),/*#__PURE__*/React.createElement(Dropdown.Menu,{className:\"dropdown-menu btn-normal-2-menu dropdown-menu-right\"},/*#__PURE__*/React.createElement(Media,{as:\"li\"},/*#__PURE__*/React.createElement(Link,{to:\"/\"+props.chatMessages.data.user.user_unique_id},\"View Profile\"))))),/*#__PURE__*/React.createElement(\"span\",{className:\"post-icons padding-top-lg\",style:{display:\"none\"}},/*#__PURE__*/React.createElement(Dropdown,null,/*#__PURE__*/React.createElement(Dropdown.Toggle,{className:\"btn btn-default dropdown-toggle\",type:\"button\",id:\"dropdown-basic\"},/*#__PURE__*/React.createElement(Image,{src:\"assets/images/icons/vertical-dots.svg\",className:\"svg-clone vertical-dots\"})),/*#__PURE__*/React.createElement(Dropdown.Menu,{className:\"dropdown-menu dropdown-menu-right\"},/*#__PURE__*/React.createElement(Media,{as:\"li\"},/*#__PURE__*/React.createElement(Link,{to:\"#\"},\" \",t(\"copy_link_to_post\"),\" \")),/*#__PURE__*/React.createElement(Media,{as:\"li\"},/*#__PURE__*/React.createElement(Link,{to:\"#\"},\" \",t(\"hide_paid_blurred_from_the_home_feed\"),\" \")),/*#__PURE__*/React.createElement(Media,{as:\"li\",className:\"divider\"}),/*#__PURE__*/React.createElement(Media,{as:\"li\"},/*#__PURE__*/React.createElement(Link,{to:\"#\"},\" \",t(\"i_dont_like_this_post\"),\" \")),/*#__PURE__*/React.createElement(Media,{as:\"li\"},/*#__PURE__*/React.createElement(Link,{to:\"#\"},\" \",t(\"hide_users_posts_from_feed\"),\" \"))))),/*#__PURE__*/React.createElement(\"div\",{className:\"chat-subheader hidden\"},/*#__PURE__*/React.createElement(\"div\",{className:\"chat-user-status\"},t(\"last_seen\"),\" \",/*#__PURE__*/React.createElement(\"span\",{title:\"Sep 7, 3:12 pm\"},\" 1 \",t(\"hour_ago\"),\" \")),/*#__PURE__*/React.createElement(Button,{type:\"button\",className:\"chat-subheader-btn\"},/*#__PURE__*/React.createElement(Image,{src:\"assets/images/icons/star.svg\",className:\"svg-clone\",width:\"12\"})),/*#__PURE__*/React.createElement(Button,{type:\"button\",className:\"chat-subheader-btn\"},/*#__PURE__*/React.createElement(Image,{src:\"assets/images/icons/notification.svg\",className:\"svg-clone\",width:\"12\"})),/*#__PURE__*/React.createElement(Button,{type:\"button\",className:\"chat-subheader-btn\"},/*#__PURE__*/React.createElement(Image,{src:\"assets/images/icons/gallery.svg\",className:\"svg-clone\",width:\"12\"}),/*#__PURE__*/React.createElement(\"span\",null,t(\"gallery\"))),/*#__PURE__*/React.createElement(Button,{type:\"button\",className:\"chat-subheader-btn\"},/*#__PURE__*/React.createElement(Image,{src:\"assets/images/icons/search.svg\",className:\"svg-clone\",width:\"12\"}),/*#__PURE__*/React.createElement(\"span\",null,t(\"find\"))))),/*#__PURE__*/React.createElement(\"div\",{className:\"chat-area\"},/*#__PURE__*/React.createElement(\"div\",{className:\"chat-wrapper scrollbar\",id:\"options-holder\"},/*#__PURE__*/React.createElement(\"div\",{className:\"chat-message padding overflow\",id:\"check\",ref:messageRef},props.chatMessages.data.messages.length>0?props.chatMessages.data.messages.map(function(chatMessage,index){return/*#__PURE__*/React.createElement(React.Fragment,null,chatMessage.from_user_id==localStorage.getItem(\"userId\")?/*#__PURE__*/React.createElement(\"div\",{className:\"chat-message chat-message-sender\"},/*#__PURE__*/React.createElement(Image,{className:\"chat-image chat-image-default\",src:localStorage.getItem(\"user_picture\")}),/*#__PURE__*/React.createElement(\"div\",{className:\"chat-message-wrapper\"},/*#__PURE__*/React.createElement(\"div\",{className:\"chat-message-content\"},/*#__PURE__*/React.createElement(\"p\",null,chatMessage.message)),chatMessage.chat_asset_url&&chatMessage.file_type==\"video\"?/*#__PURE__*/React.createElement(ReactPlayer,{url:chatMessage.chat_asset_url,controls:true,width:\"450px\",height:\"450px\",className:\"post-video-size\"}):\"\",/*#__PURE__*/React.createElement(\"div\",null,chatMessage.chat_asset_url&&chatMessage.file_type==\"image\"?/*#__PURE__*/React.createElement(Image,{src:chatMessage.chat_asset_url,className:\"chat-view-image\"// onClick={(event) =>\n//   handleImagePreview(event, 1)\n// }\n}):\"\",chatMessage.is_user_needs_pay===1?/*#__PURE__*/React.createElement(\"div\",{className:\"gallery-top-btn-sec\"},/*#__PURE__*/React.createElement(Button,{className:\"subscribe-post-btn-sec\",onClick:function onClick(event){return handleAssetPayment(event,chatMessage.chat_message_id,chatMessage.amount,chatMessage.amount_formatted);}},chatMessage.payment_text)):\"\"),/*#__PURE__*/React.createElement(\"div\",{className:\"chat-details\"},/*#__PURE__*/React.createElement(\"span\",{className:\"chat-message-localization font-size-small\"},chatMessage.created),/*#__PURE__*/React.createElement(\"span\",{className:\"chat-message-read-status font-size-small\"})))):/*#__PURE__*/React.createElement(\"div\",{className:\"chat-message chat-message-recipient\"},/*#__PURE__*/React.createElement(Image,{className:\"chat-image chat-image-default\",src:props.chatMessages.data.user.picture}),/*#__PURE__*/React.createElement(\"div\",{className:\"chat-message-wrapper gallery js-gallery\"},/*#__PURE__*/React.createElement(\"div\",{className:\"chat-message-content\"},/*#__PURE__*/React.createElement(\"p\",null,chatMessage.message)),chatMessage.chat_asset_url&&chatMessage.file_type==\"video\"?chatMessage.is_user_needs_pay===1?/*#__PURE__*/React.createElement(Image,{src:chatMessage.chat_asset_url,className:\"chat-view-image\"}):/*#__PURE__*/React.createElement(ReactPlayer,{url:chatMessage.chat_asset_url,controls:true,width:\"450px\",height:\"450px\",className:\"post-video-size chat-room-video-display\"}):\"\",/*#__PURE__*/React.createElement(\"div\",null,chatMessage.chat_asset_url&&chatMessage.file_type==\"image\"?/*#__PURE__*/React.createElement(Image,{src:chatMessage.chat_asset_url,className:\"chat-view-image\"// onClick={(event) =>\n//   handleImagePreview(event, 1)\n// }\n}):\"\",chatMessage.is_user_needs_pay===1?/*#__PURE__*/React.createElement(\"div\",{className:\"gallery-top-btn-sec chat-room-pay-display\"},/*#__PURE__*/React.createElement(Button,{className:\"subscribe-post-btn-sec\",onClick:function onClick(event){return handleAssetPayment(event,chatMessage.chat_message_id,chatMessage.amount,chatMessage.amount_formatted);}},chatMessage.payment_text)):\"\"),/*#__PURE__*/React.createElement(\"div\",{className:\"chat-details\"},/*#__PURE__*/React.createElement(\"span\",{className:\"chat-message-localization font-size-small\"},chatMessage.created)))),\" \");}):\"\")),/*#__PURE__*/React.createElement(\"div\",{style:{borderTop:\"1px solid rgba(138, 150, 163, 0.2)\"}},/*#__PURE__*/React.createElement(\"div\",{className:\"chats-post-footer\"},/*#__PURE__*/React.createElement(\"div\",null),/*#__PURE__*/React.createElement(\"div\",{className:\"chat-post\"},/*#__PURE__*/React.createElement(\"div\",{className:\"chat-textarea-price-wrapper\"},/*#__PURE__*/React.createElement(\"div\",{className:\"\"},/*#__PURE__*/React.createElement(InputGroup,{className:\"mb-3\"},/*#__PURE__*/React.createElement(FormControl,{controlId:\"chat-input-area\",placeholder:\"Type a message\",name:\"text\",rows:\"1\",className:\"form-control chat-input\",style:{overflow:\"hidden\",overflowWrap:\"break-word\",height:\"48px\"},value:inputMessage,onChange:function onChange(event){chatInputChange(event.currentTarget.value);}}),configuration.get(\"configData.is_chat_asset_enabled\")==1?/*#__PURE__*/React.createElement(InputGroup.Append,null,/*#__PURE__*/React.createElement(InputGroup.Text,{id:\"basic-addon2\"},/*#__PURE__*/React.createElement(Button,{type:\"button\",\"data-can_send\":\"true\",className:\"g-btn m-rounded b-chat__btn-submit\",onClick:function onClick(){return handleAssetUploadModal(\"image\");}},/*#__PURE__*/React.createElement(Image,{src:window.location.origin+\"/assets/images/icons/picture.svg\",className:\"svg-clone  wh-32\"})))):\"\",configuration.get(\"configData.is_chat_asset_enabled\")==1?/*#__PURE__*/React.createElement(InputGroup.Append,null,/*#__PURE__*/React.createElement(InputGroup.Text,{id:\"basic-addon2\"},/*#__PURE__*/React.createElement(Button,{type:\"button\",\"data-can_send\":\"true\",className:\"g-btn m-rounded b-chat__btn-submit\",onClick:function onClick(){return handleAssetUploadModal(\"video\");}},/*#__PURE__*/React.createElement(Image,{src:window.location.origin+\"/assets/images/icons/movie.svg\",className:\"svg-clone  wh-32\"})))):\"\",/*#__PURE__*/React.createElement(InputGroup.Append,null,/*#__PURE__*/React.createElement(InputGroup.Text,{id:\"basic-addon2\"},/*#__PURE__*/React.createElement(Button,{type:\"button\",\"data-can_send\":\"true\",className:\"btn gradient-btn gradientcolor messagebtn\",onClick:handleChatSubmit},/*#__PURE__*/React.createElement(Image,{src:\"assets/images/icons/send.svg\",className:\"svg-clone\"}))))))))))))))),/*#__PURE__*/React.createElement(ChatAssetModal,{chatAssetUpload:chatAssetUpload,closeChatAssetUploadModal:closeChatAssetUploadModal,fileType:fileType,toUserId:toUserId}),props.chatMessages.loading?t(\"loading\"):/*#__PURE__*/React.createElement(AssetPaymentModal,{chatPayment:chatPayment,closePaymentModal:closePaymentModal,paymentData:paymentData})));};var mapStateToPros=function mapStateToPros(state){return{chatUsers:state.chat.chatUsers,chatMessages:state.chat.messages,assetUpload:state.chatAsset.saveAssetUpload};};function mapDispatchToProps(dispatch){return{dispatch:dispatch};}export default connect(mapStateToPros,mapDispatchToProps)(translate(MessageIndex));","map":{"version":3,"sources":["/home/codegama/bhawya/source_code/fx-frontend-base/src/components/Messages/MessageIndex.jsx"],"names":["React","useEffect","useState","useRef","Link","Form","Button","Container","Row","Col","Dropdown","Image","Media","InputGroup","FormControl","Modal","Tab","Nav","connect","addMessageContent","fetchChatMessageStart","fetchChatUsersStart","ChatUserList","InboxNoDataFound","io","configuration","translate","t","InboxLoader","getErrorNotificationMessage","createNotification","VerifiedBadgeNoShadow","ChatAssetModal","ReactPlayer","AssetPaymentModal","$","window","chatSocket","MessageIndex","props","activeChat","setActiveChat","toUserId","setToUserId","inputMessage","setInputMessage","initialHeight","setInitialHeight","messageRef","dispatch","chatSocketUrl","get","notificationMessage","location","assign","current","scrollIntoView","behavior","block","inline","chatUsers","loading","data","users","length","console","log","to_user_id","chatSocketConnect","objDiv","document","getElementById","differenceNumber","offsetHeight","scrollHeight","scrollTop","chatMessages","messages","query","localStorage","getItem","emit","commonid","myid","chatContent","on","newData","content","push","changeUser","event","chat","index","disconnect","preventDefault","from_user_id","handleChatSubmit","undefined","chatData","message","type","user_picture","loggedin_user_id","created","Date","from_username","from_displayname","from_userpicture","from_user_unique_id","to_username","to_displayname","to_userpicture","to_user_unique_id","chatInputChange","value","chatAssetUpload","setChatAssetUpload","fileType","setFileType","closeChatAssetUploadModal","handleAssetUploadModal","assetUpload","handleMediaSubmit","assetData","chat_asset","assetMessage","chat_message","chat_message_id","chat_asset_id","chat_asset_url","amount","blur_file","file","file_type","is_user_needs_pay","amount_formatted","payment_text","chatMessageData","paymentData","setPaymentData","chatPayment","setPaymentModal","handleAssetPayment","closePaymentModal","user","user_unique_id","name","is_verified_badge","display","map","chatMessage","picture","borderTop","overflow","overflowWrap","height","currentTarget","origin","mapStateToPros","state","chatAsset","saveAssetUpload","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport {\n  Form,\n  Button,\n  Container,\n  Row,\n  Col,\n  Dropdown,\n  Image,\n  Media,\n  InputGroup,\n  FormControl,\n  Modal,\n  Tab,\n  Nav,\n} from \"react-bootstrap\";\nimport { connect } from \"react-redux\";\nimport {\n  addMessageContent,\n  fetchChatMessageStart,\n  fetchChatUsersStart,\n} from \"../../store/actions/ChatAction\";\nimport ChatUserList from \"./ChatUserList\";\nimport InboxNoDataFound from \"../NoDataFound/InboxNoDataFound\";\nimport io from \"socket.io-client\";\nimport configuration from \"react-global-configuration\";\nimport { translate, t } from \"react-multi-lang\";\n\nimport InboxLoader from \"../Loader/InboxLoader\";\nimport { getErrorNotificationMessage } from \"../helper/NotificationMessage\";\nimport { createNotification } from \"react-redux-notify/lib/modules/Notifications\";\nimport VerifiedBadgeNoShadow from \"../Handlers/VerifiedBadgeNoShadow\";\nimport ChatAssetModal from \"../helper/ChatAssetModal\";\nimport ReactPlayer from \"react-player/lazy\";\nimport AssetPaymentModal from \"../helper/AssetPaymentModal\";\n\nconst $ = window.$;\n\nlet chatSocket;\n\nconst MessageIndex = (props) => {\n  const [activeChat, setActiveChat] = useState(0);\n  const [toUserId, setToUserId] = useState(0);\n  const [inputMessage, setInputMessage] = useState(\"\");\n  const [initialHeight, setInitialHeight] = useState(0);\n\n  const messageRef = useRef();\n\n  useEffect(() => {\n    props.dispatch(fetchChatUsersStart());\n    let chatSocketUrl = configuration.get(\"configData.chat_socket_url\");\n    if (chatSocketUrl === \"\") {\n      const notificationMessage = getErrorNotificationMessage(\n        \"Socket URL is not configured. Chat wil not work...\"\n      );\n      props.dispatch(createNotification(notificationMessage));\n      window.location.assign(\"/home\");\n    }\n    if (messageRef.current) {\n      messageRef.current.scrollIntoView({\n        behavior: \"smooth\",\n        block: \"end\",\n        inline: \"nearest\",\n      });\n    }\n  }, []);\n\n  useEffect(() => {\n    if (\n      props.chatUsers.loading === false &&\n      props.chatUsers.data.users.length > 0\n    ) {\n      console.log(\"Number of times called true  \");\n      setToUserId(props.chatUsers.data.users[0].to_user_id);\n      chatSocketConnect(props.chatUsers.data.users[0].to_user_id);\n    } else {\n    }\n  }, [!props.chatUsers.loading]);\n\n  // Scroll down function..\n  useEffect(() => {\n    console.log(\"Scroll down..\");\n    const objDiv = document.getElementById(\"options-holder\");\n    if (objDiv != null) {\n      let differenceNumber =\n        objDiv.offsetHeight > objDiv.scrollHeight\n          ? objDiv.offsetHeight - objDiv.scrollHeight\n          : objDiv.scrollHeight - objDiv.offsetHeight;\n\n      if (differenceNumber > 280) {\n        objDiv.scrollTop = objDiv.scrollHeight;\n      } else {\n        objDiv.scrollTop = initialHeight;\n        setInitialHeight(initialHeight + 20);\n      }\n    }\n  }, [props.chatMessages.data.messages]);\n\n  const chatSocketConnect = (to_user_id) => {\n    // check the socket url is configured\n    let chatSocketUrl = configuration.get(\"configData.chat_socket_url\");\n    console.log(\"chatSocket\", chatSocketUrl);\n    console.log(\"Input ID\", to_user_id);\n    if (chatSocketUrl) {\n      chatSocket = io(chatSocketUrl, {\n        query:\n          `commonid:'user_id_` +\n          localStorage.getItem(\"userId\") +\n          `_to_user_id_` +\n          to_user_id +\n          `',myid:` +\n          localStorage.getItem(\"userId\"),\n      });\n      console.log(\"chatSocket\", chatSocket);\n      chatSocket.emit(\"update sender\", {\n        commonid:\n          \"user_id_\" +\n          localStorage.getItem(\"userId\") +\n          \"_to_user_id_\" +\n          to_user_id,\n        myid: localStorage.getItem(\"userId\"),\n      });\n      let chatContent;\n      chatSocket.on(\"message\", (newData) => {\n        let content = [];\n        content.push(newData);\n        // chatContent = [...this.state.chatData, ...content];\n        // this.setState({ chatData: chatContent });\n        console.log(content);\n        props.dispatch(addMessageContent(content));\n      });\n    }\n  };\n\n  const changeUser = (event, chat, index) => {\n    chatSocket.disconnect();\n    event.preventDefault();\n    setActiveChat(index);\n    let to_user_id =\n      chat.to_user_id == localStorage.getItem(\"userId\")\n        ? chat.from_user_id\n        : chat.to_user_id;\n    setToUserId(to_user_id);\n\n    props.dispatch(\n      fetchChatMessageStart({\n        to_user_id: chat.to_user_id,\n        from_user_id: chat.from_user_id,\n      })\n    );\n    chatSocketConnect(to_user_id);\n  };\n\n  const handleChatSubmit = (event) => {\n    event.preventDefault();\n    let chatSocketUrl = configuration.get(\"configData.chat_socket_url\");\n\n    if (chatSocketUrl != undefined && inputMessage) {\n      let chatData = [\n        {\n          from_user_id: localStorage.getItem(\"userId\"),\n          to_user_id: toUserId,\n          message: inputMessage,\n          type: \"uu\",\n          user_picture: localStorage.getItem(\"user_picture\"),\n          loggedin_user_id: localStorage.getItem(\"userId\"),\n          created: Date(),\n          from_username: localStorage.getItem(\"username\"),\n          from_displayname: localStorage.getItem(\"name\"),\n          from_userpicture: localStorage.getItem(\"user_picture\"),\n          from_user_unique_id: \"\",\n          to_username: \"\",\n          to_displayname: \"\",\n          to_userpicture: \"\",\n          to_user_unique_id: \"\",\n        },\n      ];\n      chatSocket.emit(\"message\", chatData[0]);\n      let messages;\n      if (props.chatMessages.data.messages != null) {\n        messages = [...props.chatMessages.data.messages, ...chatData];\n      } else {\n        messages = [...chatData];\n      }\n\n      setInputMessage(\"\");\n      props.dispatch(addMessageContent(chatData));\n    }\n  };\n\n  const chatInputChange = (value) => {\n    setInputMessage(value);\n  };\n\n  const [chatAssetUpload, setChatAssetUpload] = useState(false);\n  const [fileType, setFileType] = useState(\"picture\");\n\n  const closeChatAssetUploadModal = () => {\n    setChatAssetUpload(false);\n  };\n\n  const handleAssetUploadModal = (fileType) => {\n    setChatAssetUpload(true);\n    setFileType(fileType);\n  };\n\n  useEffect(() => {\n    props.assetUpload.loading || handleMediaSubmit();\n  }, [props.assetUpload.loading]);\n\n  const handleMediaSubmit = () => {\n    const assetData = props.assetUpload.data.chat_asset;\n    const assetMessage = props.assetUpload.data.chat_message;\n    let chatSocketUrl = configuration.get(\"configData.chat_socket_url\");\n    if (chatSocketUrl != undefined && assetData && assetMessage) {\n      let chatData = [\n        {\n          from_user_id: localStorage.getItem(\"userId\"),\n          to_user_id: toUserId,\n          chat_message_id: assetMessage ? assetMessage.chat_message_id : \"\",\n          message: assetMessage ? assetMessage.message : \"\",\n          type: \"uu\",\n          user_picture: localStorage.getItem(\"user_picture\"),\n          loggedin_user_id: localStorage.getItem(\"userId\"),\n          created: Date(),\n          from_username: localStorage.getItem(\"username\"),\n          from_displayname: localStorage.getItem(\"name\"),\n          from_userpicture: localStorage.getItem(\"user_picture\"),\n          from_user_unique_id: \"\",\n          to_username: \"\",\n          to_displayname: \"\",\n          to_userpicture: \"\",\n          to_user_unique_id: \"\",\n          chat_asset_id: assetData ? assetData.chat_asset_id : \"\",\n          chat_asset_url:\n            assetMessage.amount > 0 ? assetData.blur_file : assetData.file,\n          file_type: assetData.file_type,\n          is_user_needs_pay: assetMessage.amount > 0 ? 1 : 0,\n          amount: assetMessage.amount > 0 ? assetMessage.amount : 0,\n          amount_formatted:\n            assetMessage.amount > 0 ? assetMessage.amount_formatted : 0,\n          payment_text:\n            assetMessage.amount > 0\n              ? \"UNLOCK MESSAGE FOR \" + assetMessage.amount_formatted\n              : \"\",\n        },\n      ];\n\n      let chatMessageData = [\n        {\n          from_user_id: localStorage.getItem(\"userId\"),\n          to_user_id: toUserId,\n          chat_message_id: assetMessage ? assetMessage.chat_message_id : \"\",\n          message: assetMessage ? assetMessage.message : \"\",\n          type: \"uu\",\n          user_picture: localStorage.getItem(\"user_picture\"),\n          loggedin_user_id: localStorage.getItem(\"userId\"),\n          created: Date(),\n          from_username: localStorage.getItem(\"username\"),\n          from_displayname: localStorage.getItem(\"name\"),\n          from_userpicture: localStorage.getItem(\"user_picture\"),\n          from_user_unique_id: \"\",\n          to_username: \"\",\n          to_displayname: \"\",\n          to_userpicture: \"\",\n          to_user_unique_id: \"\",\n          chat_asset_id: assetData ? assetData.chat_asset_id : \"\",\n          chat_asset_url: assetData.file,\n          file_type: assetData.file_type,\n          amount: assetMessage.amount > 0 ? assetMessage.amount : 0,\n          amount_formatted:\n            assetMessage.amount > 0 ? assetMessage.amount_formatted : 0,\n          is_user_needs_pay: 0,\n          payment_text: \"\",\n        },\n      ];\n      chatSocket.emit(\"message\", chatData[0]);\n      let messages;\n      if (props.chatMessages.data.messages != null) {\n        messages = [...props.chatMessages.data.messages, ...chatMessageData];\n      } else {\n        messages = [...chatMessageData];\n      }\n      if (assetData) {\n        closeChatAssetUploadModal();\n      }\n      setInputMessage(\"\");\n      props.dispatch(addMessageContent(chatMessageData));\n    }\n  };\n\n  const [paymentData, setPaymentData] = useState({\n    chat_message_id: 0,\n    from_user_id: localStorage.getItem(\"userId\"),\n    to_user_id: toUserId,\n    amount_formatted: 0,\n    amount: 0,\n  });\n\n  const [chatPayment, setPaymentModal] = useState(false);\n\n  const handleAssetPayment = (\n    event,\n    chat_message_id,\n    amount_formatted,\n    amount\n  ) => {\n    event.preventDefault();\n    setPaymentData({\n      ...paymentData,\n      chat_message_id: chat_message_id,\n      amount: amount,\n      amount_formatted: amount_formatted,\n    });\n    setPaymentModal(true);\n  };\n  const closePaymentModal = () => {\n    setPaymentModal(false);\n  };\n  return (\n    <>\n      <div className=\"message-page\">\n        <Container>\n          <Row>\n            {props.chatUsers.loading ? (\n              <InboxLoader></InboxLoader>\n            ) : props.chatUsers.data.users.length > 0 ? (\n              <ChatUserList\n                chatUsers={props.chatUsers.data}\n                activeChat={activeChat}\n                setActiveChat={setActiveChat}\n                changeUser={changeUser}\n              />\n            ) : (\n              <InboxNoDataFound />\n            )}\n            <Col\n              sm={12}\n              md={12}\n              lg={7}\n              xl={8}\n              className=\"resp-mrg-btn-xs margin-col col8-sm\"\n            >\n              {props.chatMessages.loading ? (\n                \"\"\n              ) : (\n                <Row className=\"msg-row-chat\">\n                  <div className=\"msg-header\">\n                    {/* <Button className=\"chat-header-back\">\n                    <Image\n                      src={window.location.origin + \"/assets/images/icons/back.svg\"}\n                      className=\"svg-clone\"\n                    />\n                  </Button> */}\n                    <h1 className=\"chat-section-title\">\n                      <div className=\"chat-section-title-width\">\n                        <Link\n                          to={`/` + props.chatMessages.data.user.user_unique_id}\n                          className=\"chat-user-name\"\n                        >\n                          {props.chatMessages.data.user.name}{\" \"}\n                          {props.chatMessages.data.user.is_verified_badge ==\n                          1 ? (\n                            // <img\n                            //   className=\"verified-badge\"\n                            //   alt=\"verified-badge\"\n                            //   src={\n                            //     window.location.origin +\n                            //     \"/assets/images/verified.svg\"\n                            //   }\n                            // />\n                            <VerifiedBadgeNoShadow />\n                          ) : null}\n                        </Link>\n                      </div>\n                    </h1>\n                    <div className=\"drop-down-chat-sec\">\n                      <Dropdown>\n                        <Dropdown.Toggle\n                          className=\"btn btn-default dropdown-toggle btn-normal-2\"\n                          type=\"button\"\n                          id=\"dropdown-basic\"\n                        >\n                          <i className=\"fas fa-ellipsis-v\"></i>\n                        </Dropdown.Toggle>\n                        <Dropdown.Menu className=\"dropdown-menu btn-normal-2-menu dropdown-menu-right\">\n                          <Media as=\"li\">\n                            <Link\n                              to={\n                                `/` +\n                                props.chatMessages.data.user.user_unique_id\n                              }\n                            >\n                              View Profile\n                            </Link>\n                          </Media>\n                          {/* <Media as=\"li\" className=\"divider\"></Media> */}\n                        </Dropdown.Menu>\n                      </Dropdown>\n                    </div>\n                    <span\n                      className=\"post-icons padding-top-lg\"\n                      style={{ display: \"none\" }}\n                    >\n                      <Dropdown>\n                        <Dropdown.Toggle\n                          className=\"btn btn-default dropdown-toggle\"\n                          type=\"button\"\n                          id=\"dropdown-basic\"\n                        >\n                          <Image\n                            src=\"assets/images/icons/vertical-dots.svg\"\n                            className=\"svg-clone vertical-dots\"\n                          />\n                        </Dropdown.Toggle>\n                        <Dropdown.Menu className=\"dropdown-menu dropdown-menu-right\">\n                          <Media as=\"li\">\n                            <Link to=\"#\"> {t(\"copy_link_to_post\")} </Link>\n                          </Media>\n                          <Media as=\"li\">\n                            <Link to=\"#\">\n                              {\" \"}\n                              {t(\"hide_paid_blurred_from_the_home_feed\")}{\" \"}\n                            </Link>\n                          </Media>\n                          <Media as=\"li\" className=\"divider\"></Media>\n                          <Media as=\"li\">\n                            <Link to=\"#\"> {t(\"i_dont_like_this_post\")} </Link>\n                          </Media>\n                          <Media as=\"li\">\n                            <Link to=\"#\">\n                              {\" \"}\n                              {t(\"hide_users_posts_from_feed\")}{\" \"}\n                            </Link>\n                          </Media>\n                        </Dropdown.Menu>\n                      </Dropdown>\n                    </span>\n                    <div className=\"chat-subheader hidden\">\n                      <div className=\"chat-user-status\">\n                        {t(\"last_seen\")}{\" \"}\n                        <span title=\"Sep 7, 3:12 pm\"> 1 {t(\"hour_ago\")} </span>\n                      </div>\n\n                      <Button type=\"button\" className=\"chat-subheader-btn\">\n                        <Image\n                          src=\"assets/images/icons/star.svg\"\n                          className=\"svg-clone\"\n                          width=\"12\"\n                        />\n                      </Button>\n                      <Button type=\"button\" className=\"chat-subheader-btn\">\n                        <Image\n                          src=\"assets/images/icons/notification.svg\"\n                          className=\"svg-clone\"\n                          width=\"12\"\n                        />\n                      </Button>\n                      <Button type=\"button\" className=\"chat-subheader-btn\">\n                        <Image\n                          src=\"assets/images/icons/gallery.svg\"\n                          className=\"svg-clone\"\n                          width=\"12\"\n                        />\n\n                        <span>{t(\"gallery\")}</span>\n                      </Button>\n                      <Button type=\"button\" className=\"chat-subheader-btn\">\n                        <Image\n                          src=\"assets/images/icons/search.svg\"\n                          className=\"svg-clone\"\n                          width=\"12\"\n                        />\n\n                        <span>{t(\"find\")}</span>\n                      </Button>\n                    </div>\n                  </div>\n\n                  <div className=\"chat-area\">\n                    <div className=\"chat-wrapper scrollbar\" id=\"options-holder\">\n                      <div\n                        className=\"chat-message padding overflow\"\n                        id=\"check\"\n                        ref={messageRef}\n                      >\n                        {props.chatMessages.data.messages.length > 0\n                          ? props.chatMessages.data.messages.map(\n                              (chatMessage, index) => (\n                                <>\n                                  {chatMessage.from_user_id ==\n                                  localStorage.getItem(\"userId\") ? (\n                                    <div className=\"chat-message chat-message-sender\">\n                                      <Image\n                                        className=\"chat-image chat-image-default\"\n                                        src={localStorage.getItem(\n                                          \"user_picture\"\n                                        )}\n                                      />\n\n                                      <div className=\"chat-message-wrapper\">\n                                        <div className=\"chat-message-content\">\n                                          <p>{chatMessage.message}</p>\n                                        </div>\n                                        {chatMessage.chat_asset_url &&\n                                        chatMessage.file_type == \"video\" ? (\n                                          <ReactPlayer\n                                            url={chatMessage.chat_asset_url}\n                                            controls={true}\n                                            width=\"450px\"\n                                            height=\"450px\"\n                                            className=\"post-video-size\"\n                                          />\n                                        ) : (\n                                          \"\"\n                                        )}\n                                        <div>\n                                          {chatMessage.chat_asset_url &&\n                                          chatMessage.file_type == \"image\" ? (\n                                            <Image\n                                              src={chatMessage.chat_asset_url}\n                                              className=\"chat-view-image\"\n                                              // onClick={(event) =>\n                                              //   handleImagePreview(event, 1)\n                                              // }\n                                            />\n                                          ) : (\n                                            \"\"\n                                          )}\n\n                                          {chatMessage.is_user_needs_pay ===\n                                          1 ? (\n                                            <div className=\"gallery-top-btn-sec\">\n                                              <Button\n                                                className=\"subscribe-post-btn-sec\"\n                                                onClick={(event) =>\n                                                  handleAssetPayment(\n                                                    event,\n                                                    chatMessage.chat_message_id,\n                                                    chatMessage.amount,\n                                                    chatMessage.amount_formatted\n                                                  )\n                                                }\n                                              >\n                                                {chatMessage.payment_text}\n                                              </Button>\n                                            </div>\n                                          ) : (\n                                            \"\"\n                                          )}\n                                        </div>\n                                        <div className=\"chat-details\">\n                                          <span className=\"chat-message-localization font-size-small\">\n                                            {chatMessage.created}\n                                          </span>\n                                          <span className=\"chat-message-read-status font-size-small\"></span>\n                                        </div>\n                                      </div>\n                                    </div>\n                                  ) : (\n                                    <div className=\"chat-message chat-message-recipient\">\n                                      <Image\n                                        className=\"chat-image chat-image-default\"\n                                        src={\n                                          props.chatMessages.data.user.picture\n                                        }\n                                      />\n\n                                      <div className=\"chat-message-wrapper gallery js-gallery\">\n                                        <div className=\"chat-message-content\">\n                                          <p>{chatMessage.message}</p>\n                                        </div>\n                                        {chatMessage.chat_asset_url &&\n                                        chatMessage.file_type == \"video\" ? (\n                                          chatMessage.is_user_needs_pay ===\n                                          1 ? (\n                                            <Image\n                                              src={chatMessage.chat_asset_url}\n                                              className=\"chat-view-image\"\n                                            ></Image>\n                                          ) : (\n                                            <ReactPlayer\n                                              url={chatMessage.chat_asset_url}\n                                              controls={true}\n                                              width=\"450px\"\n                                              height=\"450px\"\n                                              className=\"post-video-size chat-room-video-display\"\n                                            />\n                                          )\n                                        ) : (\n                                          \"\"\n                                        )}\n                                        <div>\n                                          {chatMessage.chat_asset_url &&\n                                          chatMessage.file_type == \"image\" ? (\n                                            <Image\n                                              src={chatMessage.chat_asset_url}\n                                              className=\"chat-view-image\"\n                                              // onClick={(event) =>\n                                              //   handleImagePreview(event, 1)\n                                              // }\n                                            />\n                                          ) : (\n                                            \"\"\n                                          )}\n\n                                          {chatMessage.is_user_needs_pay ===\n                                          1 ? (\n                                            <div className=\"gallery-top-btn-sec chat-room-pay-display\">\n                                              <Button\n                                                className=\"subscribe-post-btn-sec\"\n                                                onClick={(event) =>\n                                                  handleAssetPayment(\n                                                    event,\n                                                    chatMessage.chat_message_id,\n                                                    chatMessage.amount,\n                                                    chatMessage.amount_formatted\n                                                  )\n                                                }\n                                              >\n                                                {chatMessage.payment_text}\n                                              </Button>\n                                            </div>\n                                          ) : (\n                                            \"\"\n                                          )}\n                                        </div>\n                                        <div className=\"chat-details\">\n                                          <span className=\"chat-message-localization font-size-small\">\n                                            {chatMessage.created}\n                                          </span>\n                                          {/* <span className=\"chat-message-read-status font-size-small\">\n                                          , $69 not paid yet\n                                        </span> */}\n                                        </div>\n                                      </div>\n                                    </div>\n                                  )}{\" \"}\n                                </>\n                              )\n                            )\n                          : \"\"}\n                      </div>\n                    </div>\n\n                    <div\n                      style={{\n                        borderTop: \"1px solid rgba(138, 150, 163, 0.2)\",\n                      }}\n                    >\n                      <div className=\"chats-post-footer\">\n                        <div></div>\n                        <div className=\"chat-post\">\n                          <div className=\"chat-textarea-price-wrapper\">\n                            <div className=\"\">\n                              <InputGroup className=\"mb-3\">\n                                <FormControl\n                                  controlId=\"chat-input-area\"\n                                  placeholder=\"Type a message\"\n                                  name=\"text\"\n                                  rows=\"1\"\n                                  className=\"form-control chat-input\"\n                                  style={{\n                                    overflow: \"hidden\",\n                                    overflowWrap: \"break-word\",\n                                    height: \"48px\",\n                                  }}\n                                  value={inputMessage}\n                                  onChange={(event) => {\n                                    chatInputChange(event.currentTarget.value);\n                                  }}\n                                />\n                                {configuration.get(\n                                  \"configData.is_chat_asset_enabled\"\n                                ) == 1 ? (\n                                  <InputGroup.Append>\n                                    <InputGroup.Text id=\"basic-addon2\">\n                                      <Button\n                                        type=\"button\"\n                                        data-can_send=\"true\"\n                                        className=\"g-btn m-rounded b-chat__btn-submit\"\n                                        onClick={() =>\n                                          handleAssetUploadModal(\"image\")\n                                        }\n                                      >\n                                        <Image\n                                          src={\n                                            window.location.origin +\n                                            \"/assets/images/icons/picture.svg\"\n                                          }\n                                          className=\"svg-clone  wh-32\"\n                                        />\n                                      </Button>\n                                    </InputGroup.Text>\n                                  </InputGroup.Append>\n                                ) : (\n                                  \"\"\n                                )}\n                                {configuration.get(\n                                  \"configData.is_chat_asset_enabled\"\n                                ) == 1 ? (\n                                  <InputGroup.Append>\n                                    <InputGroup.Text id=\"basic-addon2\">\n                                      <Button\n                                        type=\"button\"\n                                        data-can_send=\"true\"\n                                        className=\"g-btn m-rounded b-chat__btn-submit\"\n                                        onClick={() =>\n                                          handleAssetUploadModal(\"video\")\n                                        }\n                                      >\n                                        <Image\n                                          src={\n                                            window.location.origin +\n                                            \"/assets/images/icons/movie.svg\"\n                                          }\n                                          className=\"svg-clone  wh-32\"\n                                        />\n                                      </Button>\n                                    </InputGroup.Text>\n                                  </InputGroup.Append>\n                                ) : (\n                                  \"\"\n                                )}\n                                <InputGroup.Append>\n                                  <InputGroup.Text id=\"basic-addon2\">\n                                    <Button\n                                      type=\"button\"\n                                      data-can_send=\"true\"\n                                      className=\"btn gradient-btn gradientcolor messagebtn\"\n                                      onClick={handleChatSubmit}\n                                    >\n                                      <Image\n                                        src=\"assets/images/icons/send.svg\"\n                                        className=\"svg-clone\"\n                                      />\n                                    </Button>\n                                  </InputGroup.Text>\n                                </InputGroup.Append>\n                              </InputGroup>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </Row>\n              )}\n            </Col>\n          </Row>\n        </Container>\n\n        <ChatAssetModal\n          chatAssetUpload={chatAssetUpload}\n          closeChatAssetUploadModal={closeChatAssetUploadModal}\n          fileType={fileType}\n          toUserId={toUserId}\n        />\n        {props.chatMessages.loading ? (\n          t(\"loading\")\n        ) : (\n          <AssetPaymentModal\n            chatPayment={chatPayment}\n            closePaymentModal={closePaymentModal}\n            paymentData={paymentData}\n          />\n        )}\n      </div>\n    </>\n  );\n};\n\nconst mapStateToPros = (state) => ({\n  chatUsers: state.chat.chatUsers,\n  chatMessages: state.chat.messages,\n  assetUpload: state.chatAsset.saveAssetUpload,\n});\n\nfunction mapDispatchToProps(dispatch) {\n  return { dispatch };\n}\n\nexport default connect(\n  mapStateToPros,\n  mapDispatchToProps\n)(translate(MessageIndex));\n"]},"metadata":{},"sourceType":"module"}