{"ast":null,"code":"var _jsxFileName = \"/Users/devsmac/Downloads/fx-frontend/src/components/Sample/AgoraOnetoOneAudioCall.jsx\";\nimport React, { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport { translate, t } from \"react-multi-lang\";\nimport AgoraRTC from \"agora-rtc-sdk-ng\";\nimport { Form, Button, Container, Row, Col, Table, Media, Image } from \"react-bootstrap\";\nimport { endAudioCallStart, joinAudioCallStart } from \"../../store/actions/PrivateCallAction\";\nimport configuration from \"react-global-configuration\";\nimport { Link } from \"react-router-dom\";\nconst client = AgoraRTC.createClient({\n  mode: \"live\",\n  codec: \"vp8\"\n});\nconst $ = window.$;\n\nconst AgoraOnetoOneAudioCall = props => {\n  var rtc = {\n    // For the local client.\n    client: null,\n    // For the local audio and video tracks.\n    localAudioTrack: null // localVideoTrack: null,\n\n  };\n  var localTracks = {\n    audioTrack: null\n  };\n  var localTrackState = {\n    audioTrackEnabled: true\n  };\n  var options = {\n    // Pass your app ID here.\n    appId: configuration.get(\"configData.agora_app_id\"),\n    // Set the channel name.\n    channel: \"demo_channel_name\",\n    // Pass a token if your project enables the App Certificate.\n    token: null,\n    uid: null\n  };\n  var remoteUsers = {};\n\n  async function startBasicCall() {\n    // Create an AgoraRTCClient object.\n    rtc.client = AgoraRTC.createClient({\n      mode: \"rtc\",\n      codec: \"vp8\"\n    });\n    rtc.client.on(\"user-published\", handleUserPublished);\n    rtc.client.on(\"user-unpublished\", handleUserUnpublished);\n    [options.uid, localTracks.audioTrack] = await Promise.all([// join the channel\n    await rtc.client.join(options.appId, options.channel, options.token, null), // create local tracks, using microphone and camera\n    rtc.localAudioTrack = await AgoraRTC.createMicrophoneAudioTrack()]);\n    await rtc.client.publish([rtc.localAudioTrack]);\n    console.log(\"publish success!\");\n    props.dispatch(joinAudioCallStart({\n      audio_call_request_id: props.audioCallData.audio_call_request_id\n    }));\n  }\n\n  async function subscribe(user, mediaType) {\n    const uid = user.uid; // subscribe to a remote user\n\n    await rtc.client.subscribe(user, mediaType);\n    console.log(\"subscribe success\");\n\n    if (mediaType === 'audio') {\n      user.audioTrack.play();\n    }\n  }\n\n  function handleUserPublished(user, mediaType) {\n    const id = user.uid;\n    remoteUsers[id] = user;\n    subscribe(user, mediaType);\n  }\n\n  function handleUserUnpublished(user) {// const id = user.uid;\n    // delete remoteUsers[id];\n    // $(`#player-wrapper-${id}`).remove();\n  }\n\n  startBasicCall();\n\n  async function leaveCall(is_owner) {\n    if (is_owner) {\n      // Destroy the local audio track.\n      rtc.localAudioTrack.close(); // Leave the channel.\n\n      await rtc.client.leave();\n      props.dispatch(endAudioCallStart({\n        audio_call_request_id: props.audioCallData.audio_call_request_id\n      }));\n    } else {\n      // Leave the channel.\n      await rtc.client.leave();\n    }\n\n    window.location.assign(\"/audio-calls-history\");\n  }\n\n  async function muteAudio() {\n    if (!rtc.localAudioTrack) return;\n\n    if (localTrackState.audioTrackEnabled == true) {\n      await rtc.localAudioTrack.setEnabled(false);\n      localTrackState.audioTrackEnabled = false;\n      $(\"#mute-audio\").hide();\n      $(\"#unmute-audio\").show();\n    } else {\n      await rtc.localAudioTrack.setEnabled(true);\n      localTrackState.audioTrackEnabled = true;\n      $(\"#mute-audio\").show();\n      $(\"#unmute-audio\").hide();\n    }\n  }\n\n  console.log(props.isOwner);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"agora-card\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    sm: 12,\n    xs: 12,\n    md: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"local-player\",\n    style: {\n      width: \"280px\",\n      height: \"400px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    style: {\n      width: \"280px\",\n      height: \"400px\"\n    },\n    src: props.audioCallData.model_picture,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 25\n    }\n  }))), /*#__PURE__*/React.createElement(Col, {\n    sm: 12,\n    xs: 12,\n    md: 8,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"remote-playerlist\",\n    style: {\n      width: \"825px\",\n      height: \"400px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    style: {\n      width: \"825px\",\n      height: \"400px\",\n      objectFit: \"contain\"\n    },\n    src: props.audioCallData.user_picture,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 25\n    }\n  })))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"button-group mt-3 mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    sm: 12,\n    xs: 12,\n    md: 3,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 17\n    }\n  }, props.isOwner ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"live-action-icon-sec\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"ul\", {\n    className: \"list-unstyled live-action-flex\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Media, {\n    as: \"li\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    to: \"#\",\n    onClick: () => leaveCall(props.isOwner),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(Image, {\n    src: window.location.origin + \"/assets/images/icons/end-stream.png\",\n    className: \"action-live-icon\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 37\n    }\n  }))), /*#__PURE__*/React.createElement(Media, {\n    as: \"li\",\n    id: \"mute-audio\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    to: \"#\",\n    onClick: () => muteAudio(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(Image, {\n    src: window.location.origin + \"/assets/images/icons/audio.png\",\n    className: \"action-live-icon\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 37\n    }\n  }))), /*#__PURE__*/React.createElement(Media, {\n    as: \"li\",\n    id: \"unmute-audio\",\n    style: {\n      display: \"none\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    to: \"#\",\n    onClick: () => muteAudio(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(Image, {\n    src: window.location.origin + \"/assets/images/icons/no-audio.png\",\n    className: \"action-live-icon\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 37\n    }\n  })))))) : /*#__PURE__*/React.createElement(\"div\", {\n    className: \"live-action-icon-sec\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"ul\", {\n    className: \"list-unstyled live-action-flex\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Media, {\n    as: \"li\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    to: \"#\",\n    onClick: () => leaveCall(props.isOwner),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(Image, {\n    src: window.location.origin + \"/assets/images/icons/end-stream.png\",\n    className: \"action-live-icon\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 37\n    }\n  }))))))));\n};\n\nconst mapStateToPros = state => ({});\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    dispatch\n  };\n}\n\nexport default connect(mapStateToPros, mapDispatchToProps)(translate(AgoraOnetoOneAudioCall));","map":{"version":3,"sources":["/Users/devsmac/Downloads/fx-frontend/src/components/Sample/AgoraOnetoOneAudioCall.jsx"],"names":["React","useEffect","useState","connect","translate","t","AgoraRTC","Form","Button","Container","Row","Col","Table","Media","Image","endAudioCallStart","joinAudioCallStart","configuration","Link","client","createClient","mode","codec","$","window","AgoraOnetoOneAudioCall","props","rtc","localAudioTrack","localTracks","audioTrack","localTrackState","audioTrackEnabled","options","appId","get","channel","token","uid","remoteUsers","startBasicCall","on","handleUserPublished","handleUserUnpublished","Promise","all","join","createMicrophoneAudioTrack","publish","console","log","dispatch","audio_call_request_id","audioCallData","subscribe","user","mediaType","play","id","leaveCall","is_owner","close","leave","location","assign","muteAudio","setEnabled","hide","show","isOwner","width","height","model_picture","objectFit","user_picture","origin","display","mapStateToPros","state","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport { translate, t } from \"react-multi-lang\";\nimport AgoraRTC from \"agora-rtc-sdk-ng\";\nimport { Form, Button, Container, Row, Col,Table,Media, Image  } from \"react-bootstrap\";\nimport {\n    endAudioCallStart,\n    joinAudioCallStart,\n  } from \"../../store/actions/PrivateCallAction\";\nimport configuration from \"react-global-configuration\";\nimport { Link } from \"react-router-dom\";\n\nconst client = AgoraRTC.createClient({ mode: \"live\", codec: \"vp8\" });\nconst $ = window.$;\n\nconst AgoraOnetoOneAudioCall = (props) => {\n\n    var rtc = {\n        // For the local client.\n        client: null,\n        // For the local audio and video tracks.\n        localAudioTrack: null,\n        // localVideoTrack: null,\n    };\n      \n\n    var localTracks = {\n        audioTrack: null\n    };\n\n    var localTrackState = {\n        audioTrackEnabled: true\n    }\n\n    var options = {\n        // Pass your app ID here.\n        appId: configuration.get(\"configData.agora_app_id\"),\n        // Set the channel name.\n        channel: \"demo_channel_name\",\n        // Pass a token if your project enables the App Certificate.\n        token: null,\n        uid: null,\n    };\n    \n    var remoteUsers = {};\n\n    async function startBasicCall() {\n\n        // Create an AgoraRTCClient object.\n        rtc.client = AgoraRTC.createClient({ mode: \"rtc\", codec: \"vp8\" });\n\n        rtc.client.on(\"user-published\", handleUserPublished);\n        rtc.client.on(\"user-unpublished\", handleUserUnpublished);\n\n        [options.uid, localTracks.audioTrack ] = await Promise.all([\n            // join the channel\n            await rtc.client.join(options.appId, options.channel, options.token, null),\n            // create local tracks, using microphone and camera\n            rtc.localAudioTrack = await AgoraRTC.createMicrophoneAudioTrack()\n        ]);\n\n        await rtc.client.publish([rtc.localAudioTrack]);\n\n        console.log(\"publish success!\");\n\n        props.dispatch(\n            joinAudioCallStart({\n                audio_call_request_id:props.audioCallData.audio_call_request_id,\n            })\n        );\n\n\n    }\n\n    async function subscribe(user, mediaType) {\n        const uid = user.uid;\n        // subscribe to a remote user\n        await rtc.client.subscribe(user, mediaType);\n        console.log(\"subscribe success\");\n        if (mediaType === 'audio') {\n          user.audioTrack.play();\n        }\n    }\n\n    function handleUserPublished(user, mediaType) {\n        const id = user.uid;\n        remoteUsers[id] = user;\n        subscribe(user, mediaType);\n    }\n      \n    function handleUserUnpublished(user) {\n        // const id = user.uid;\n        // delete remoteUsers[id];\n        // $(`#player-wrapper-${id}`).remove();\n    }\n\n      \n    startBasicCall();\n\n    async function leaveCall(is_owner) {\n\n        if (is_owner) {\n          // Destroy the local audio track.\n          rtc.localAudioTrack.close();\n\n          // Leave the channel.\n          await rtc.client.leave();\n          props.dispatch(\n            endAudioCallStart({\n                audio_call_request_id:props.audioCallData.audio_call_request_id,\n            })\n          );\n        } else {\n          // Leave the channel.\n          await rtc.client.leave();\n        } \n        \n        window.location.assign(\"/audio-calls-history\");\n      }\n  \n      async function muteAudio() {\n        if (!rtc.localAudioTrack) return;\n        if(localTrackState.audioTrackEnabled == true) {\n            await rtc.localAudioTrack.setEnabled(false);\n            localTrackState.audioTrackEnabled = false;\n            $(\"#mute-audio\").hide();\n            $(\"#unmute-audio\").show();\n        } else {\n            await rtc.localAudioTrack.setEnabled(true);\n            localTrackState.audioTrackEnabled = true;\n            $(\"#mute-audio\").show();\n            $(\"#unmute-audio\").hide();\n        }\n      }\n      \n      console.log(props.isOwner);\n    return (\n        <div className=\"agora-card\">\n            <div>\n                <Col sm={12} xs={12} md={4}>\n\n                    <div id=\"local-player\" style={{ width: \"280px\", height: \"400px\" }}>\n                        <img style={{ width: \"280px\", height: \"400px\" }} src={props.audioCallData.model_picture}/>\n                    </div>\n                </Col>\n                <Col sm={12} xs={12} md={8}>\n                    <div id=\"remote-playerlist\" style={{ width: \"825px\", height: \"400px\" }}>\n                        <img style={{ width: \"825px\", height: \"400px\", objectFit: \"contain\" }} src={props.audioCallData.user_picture}/>\n                    </div>\n                </Col>\n            </div>\n            <div className=\"button-group mt-3 mb-3\">\n                <Col sm={12} xs={12} md={3}>\n\n                {props.isOwner ? \n                    <>\n                    <div className=\"live-action-icon-sec\">\n                        <ul className=\"list-unstyled live-action-flex\">\n                            <Media as=\"li\">\n                                <Link to=\"#\" \n                                    onClick={() =>\n                                    leaveCall(props.isOwner)\n                                }>\n                                    <Image\n                                    src={\n                                        window.location.origin + \"/assets/images/icons/end-stream.png\"\n                                    }\n                                    className=\"action-live-icon\"\n                                    />\n                                </Link>\n                            </Media>\n                            <Media as=\"li\" id=\"mute-audio\">\n                                <Link to=\"#\"\n                                onClick={() =>\n                                    muteAudio()\n                                }>\n                                    <Image\n                                    src={\n                                        window.location.origin + \"/assets/images/icons/audio.png\"\n                                    }\n                                    className=\"action-live-icon\"\n                                    />\n                                </Link>\n                            </Media>\n                            <Media as=\"li\" id=\"unmute-audio\" style={{display: \"none\"}}>\n                                <Link to=\"#\"\n                                onClick={() =>\n                                    muteAudio()\n                                }>\n                                    <Image\n                                    src={\n                                        window.location.origin + \"/assets/images/icons/no-audio.png\"\n                                    }\n                                    className=\"action-live-icon\"\n                                    />\n                                </Link>\n                            </Media>\n                        </ul>\n                    </div>\n                    </>\n                :\n                    <div className=\"live-action-icon-sec\">\n                        <ul className=\"list-unstyled live-action-flex\">\n                            <Media as=\"li\">\n                                <Link to=\"#\" \n                                    onClick={() =>\n                                    leaveCall(props.isOwner)\n                                }>\n                                    <Image\n                                    src={\n                                        window.location.origin + \"/assets/images/icons/end-stream.png\"\n                                    }\n                                    className=\"action-live-icon\"\n                                    />\n                                </Link>\n                            </Media>\n                        </ul>\n                    </div>\n                }\n\n                </Col>\n            </div>\n        </div>\n        \n    );\n};\n\n\nconst mapStateToPros = (state) => ({\n  \n});\n\nfunction mapDispatchToProps(dispatch) {\nreturn { dispatch };\n}\n\nexport default connect(mapStateToPros, mapDispatchToProps)(translate(AgoraOnetoOneAudioCall));"]},"metadata":{},"sourceType":"module"}