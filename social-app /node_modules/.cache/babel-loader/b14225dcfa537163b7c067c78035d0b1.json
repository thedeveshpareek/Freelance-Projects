{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = StepZilla;\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _promise = _interopRequireDefault(require(\"promise\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  } else {\n    var newObj = {};\n\n    if (obj != null) {\n      for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) {\n          var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {};\n\n          if (desc.get || desc.set) {\n            Object.defineProperty(newObj, key, desc);\n          } else {\n            newObj[key] = obj[key];\n          }\n        }\n      }\n    }\n\n    newObj.default = obj;\n    return newObj;\n  }\n}\n\nfunction _typeof(obj) {\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction StepZilla(props) {\n  var _useState = (0, _react.useState)(props.startAtStep),\n      _useState2 = _slicedToArray(_useState, 2),\n      compState = _useState2[0],\n      setCompState = _useState2[1];\n\n  var _useState3 = (0, _react.useState)(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      navState = _useState4[0],\n      setNavState = _useState4[1];\n\n  var hidden = {\n    display: 'none'\n  };\n  (0, _react.useEffect)(function () {\n    setNavState(getNavStates(props.startAtStep, props.steps.length));\n  }, []); // update the header nav states via classes so they can be styled via css\n\n  var getNavStates = function getNavStates(indx, length) {\n    var styles = [];\n\n    for (var i = 0; i < length; i++) {\n      if (i < indx || !props.prevBtnOnLastStep && indx === length - 1) {\n        styles.push('done');\n      } else if (i === indx) {\n        styles.push('doing');\n      } else {\n        styles.push('todo');\n      }\n    }\n\n    return {\n      styles: styles\n    };\n  };\n\n  var getPrevNextBtnLayout = function getPrevNextBtnLayout(currentStep) {\n    // first set default values\n    var showPreviousBtn = true;\n    var showNextBtn = true;\n    var nextStepText = props.nextButtonText; // first step hide previous btn\n\n    if (currentStep === 0) {\n      showPreviousBtn = false;\n    } // second to last step change next btn text if supplied as props\n\n\n    if (currentStep === props.steps.length - 2) {\n      // if user did not give a custom nextTextOnFinalActionStep, the nextButtonText becomes the default\n      var nextTextOnFinalActionStep = props.nextTextOnFinalActionStep ? props.nextTextOnFinalActionStep : props.nextButtonText;\n      nextStepText = nextTextOnFinalActionStep || nextStepText;\n    } // last step hide next btn, hide previous btn if supplied as props\n\n\n    if (currentStep >= props.steps.length - 1) {\n      showNextBtn = false;\n      showPreviousBtn = props.prevBtnOnLastStep === false ? false : true;\n    }\n\n    return {\n      showPreviousBtn: showPreviousBtn,\n      showNextBtn: showNextBtn,\n      nextStepText: nextStepText\n    };\n  }; // which step are we in?\n\n\n  var checkNavState = function checkNavState(nextStep) {\n    if (props.onStepChange) {\n      props.onStepChange(nextStep);\n    }\n  }; // set the nav state\n\n\n  var adjustNavState = function adjustNavState(next) {\n    setNavState(getNavStates(next, props.steps.length));\n\n    if (next < props.steps.length) {\n      setCompState(next);\n    }\n\n    checkNavState(next);\n  }; // handles keydown on enter being pressed in any Child component input area. in this case it goes to the next (ignore textareas as they should allow line breaks)\n\n\n  var handleKeyDown = function handleKeyDown(evt) {\n    if (evt.which === 13) {\n      if (!props.preventEnterSubmission && evt.target.type !== 'textarea') {\n        next();\n      } else if (evt.target.type !== 'textarea') {\n        evt.preventDefault();\n      }\n    }\n  }; // this utility method lets Child components invoke a direct jump to another step\n\n\n  var _jumpToStep = function jumpToStep(evt) {\n    if (typeof evt.target === 'undefined') {\n      // a child step wants to invoke a jump between steps. in this case 'evt' is the numeric step number and not the JS event\n      adjustNavState(evt);\n    } else {\n      // the main navigation step ui is invoking a jump between steps\n      // if stepsNavigation is turned off or user clicked on existing step again (on step 2 and clicked on 2 again) then ignore\n      if (!props.stepsNavigation || evt.target.value === compState) {\n        evt.preventDefault();\n        evt.stopPropagation();\n        return;\n      } // evt is a react event so we need to persist it as we deal with aync promises which nullifies these events (https://facebook.github.io/react/docs/events.html#event-pooling)\n\n\n      evt.persist();\n      var movingBack = evt.target.value < compState; // are we trying to move back or front?\n\n      var passThroughStepsNotValid = false; // if we are jumping forward, only allow that if inbetween steps are all validated. This flag informs the logic...\n\n      var proceed = false; // flag on if we should move on\n\n      abstractStepMoveAllowedToPromise(movingBack).then(function (valid) {\n        // validation was a success (promise or sync validation). In it was a Promise's resolve()\n        // ... then proceed will be undefined, so make it true. Or else 'proceed' will carry the true/false value from sync\n        proceed = typeof valid === 'undefined' ? true : valid;\n\n        if (!movingBack) {\n          updateStepValidationFlag(proceed);\n        }\n\n        if (proceed) {\n          if (!movingBack) {\n            // looks like we are moving forward, 'reduce' a new array of step>validated values we need to check and\n            // ... 'some' that to get a decision on if we should allow moving forward\n            passThroughStepsNotValid = props.steps.reduce(function (a, c, i) {\n              if (i >= compState && i < evt.target.value) {\n                a.push(c.validated);\n              }\n\n              return a;\n            }, []).some(function (c) {\n              return c === false;\n            });\n          }\n        }\n      }).catch(function () {\n        // Promise based validation was a fail (i.e reject())\n        if (!movingBack) {\n          updateStepValidationFlag(false);\n        }\n      }).then(function () {\n        // this is like finally(), executes if error no no error\n        if (proceed && !passThroughStepsNotValid) {\n          if (evt.target.value === props.steps.length - 1 && compState === props.steps.length - 1) {\n            adjustNavState(props.steps.length);\n          } else {\n            adjustNavState(evt.target.value);\n          }\n        }\n      }).catch(function (e) {\n        if (e) {\n          // see note below called \"CatchRethrowing\"\n          // ... plus the finally then() above is what throws the JS Error so we need to catch that here specifically\n          setTimeout(function () {\n            throw e;\n          });\n        }\n      });\n    }\n  }; // move next via next button\n\n\n  var next = function next() {\n    abstractStepMoveAllowedToPromise().then(function () {\n      var proceed = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true; // validation was a success (promise or sync validation). In it was a Promise's resolve() then proceed will be undefined,\n      // ... so make it true. Or else 'proceed' will carry the true/false value from sync validation\n\n      updateStepValidationFlag(proceed);\n\n      if (proceed) {\n        adjustNavState(compState + 1);\n      }\n    }).catch(function (e) {\n      if (e) {\n        // CatchRethrowing: as we wrap StepMoveAllowed() to resolve as a Promise, the then() is invoked and the next React Component is loaded.\n        // ... during the render, if there are JS errors thrown (e.g. ReferenceError) it gets swallowed by the Promise library and comes in here (catch)\n        // ... so we need to rethrow it outside the execution stack so it behaves like a notmal JS error (i.e. halts and prints to console)\n        //\n        setTimeout(function () {\n          throw e;\n        });\n      } // Promise based validation was a fail (i.e reject())\n\n\n      updateStepValidationFlag(false);\n    });\n  }; // move behind via previous button\n\n\n  var previous = function previous() {\n    if (compState > 0) {\n      adjustNavState(compState - 1);\n    }\n  }; // update step's validation flag\n\n\n  var updateStepValidationFlag = function updateStepValidationFlag() {\n    var val = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n    props.steps[compState].validated = val; // note: if a step component returns 'underfined' then treat as \"true\".\n  };\n\n  var activeComponentRef = (0, _react.useRef)(null); // are we allowed to move forward? via the next button or via jumpToStep?\n\n  var stepMoveAllowed = function stepMoveAllowed() {\n    var skipValidationExecution = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n    var proceed = false;\n\n    if (props.dontValidate) {\n      proceed = true;\n    } else {\n      if (skipValidationExecution) {\n        // we are moving backwards in steps, in this case dont validate as it means the user is not commiting to \"save\"\n        proceed = true;\n      } else if (isStepAtIndexHOCValidationBased(compState)) {\n        // the user is using a higer order component (HOC) for validation (e.g react-validation-mixin), this wraps the StepZilla steps as a HOC,\n        // so use hocValidationAppliedTo to determine if this step needs the aync validation as per react-validation-mixin interface\n        proceed = activeComponentRef.current.refs.component.isValidated();\n      } else if (activeComponentRef.current === null || typeof activeComponentRef.current.isValidated === 'undefined') {\n        // if its a form component, it should have implemeted a public isValidated class (also pure componenets wont even have refs - i.e. a empty object). If not then continue\n        proceed = true;\n      } else {\n        // user is moving forward in steps, invoke validation as its available\n        proceed = activeComponentRef.current.isValidated();\n      }\n    }\n\n    return proceed;\n  };\n\n  var isStepAtIndexHOCValidationBased = function isStepAtIndexHOCValidationBased(stepIndex) {\n    return props.hocValidationAppliedTo && props.hocValidationAppliedTo.length > 0 && props.hocValidationAppliedTo.indexOf(stepIndex) > -1;\n  }; // a validation method is each step can be sync or async (Promise based), this utility abstracts the wrapper stepMoveAllowed to be Promise driven regardless of validation return type\n\n\n  var abstractStepMoveAllowedToPromise = function abstractStepMoveAllowedToPromise(movingBack) {\n    return _promise.default.resolve(stepMoveAllowed(movingBack));\n  }; // get the classmame of steps\n\n\n  var getClassName = function getClassName(className, i) {\n    var liClassName = '';\n\n    if (navState && navState.styles) {\n      liClassName = \"\".concat(className, \"-\").concat(navState.styles[i]); // if step ui based navigation is disabled, then dont highlight step\n\n      if (!props.stepsNavigation) {\n        liClassName += ' no-hl';\n      }\n    }\n\n    return liClassName;\n  }; // render the steps as stepsNavigation\n\n\n  var renderSteps = function renderSteps() {\n    return props.steps.map(function (s, i) {\n      return _react.default.createElement(\"li\", {\n        className: getClassName('progtrckr', i),\n        onClick: function onClick(evt) {\n          _jumpToStep(evt);\n        },\n        key: i,\n        value: i\n      }, _react.default.createElement(\"em\", null, i + 1), _react.default.createElement(\"span\", null, props.steps[i].name));\n    });\n  };\n\n  var _getPrevNextBtnLayout = getPrevNextBtnLayout(compState),\n      nextStepText = _getPrevNextBtnLayout.nextStepText,\n      showNextBtn = _getPrevNextBtnLayout.showNextBtn,\n      showPreviousBtn = _getPrevNextBtnLayout.showPreviousBtn; // clone the step component dynamically and tag it as activeComponent so we can validate it on next. also bind the jumpToStep piping method\n\n\n  var cloneExtensions = {\n    jumpToStep: function jumpToStep(t) {\n      _jumpToStep(t);\n    }\n  };\n  var componentPointer = null;\n  var compToRender = null;\n\n  if (props.steps[compState]) {\n    componentPointer = props.steps[compState].component; // S: ref binding -----\n    // we need to bind a ref to it so we can use the imperitive \"isValidated\" method when needed to prevent navigation\n    // ... we only can do this if its a (1) React Class based component or (2) A Hooks based stateful component wrapped in forwardRef\n    // (1) can only update refs if its a regular React component (not a pure component - i.e. function components with no state), so lets check that\n\n    if (componentPointer instanceof _react.Component || componentPointer.type && componentPointer.type.prototype instanceof _react.Component) {\n      // unit test deteceted that instanceof Component can be in either of these locations so test both (not sure why this is the case)\n      cloneExtensions.ref = activeComponentRef;\n    } else {\n      // (2) after react hooks was released, functional components can have state and therefore support refs\n      // ... we do this via forwardRefs. So we need to support this as well\n      // ... after testing, if both the below types are objects then it's a hooks function component wrapped in forwardRef\n      if (_typeof(componentPointer) === 'object' && _typeof(componentPointer.type) === 'object') {\n        cloneExtensions.ref = activeComponentRef;\n      }\n    } // E: ref binding -----\n\n\n    compToRender = _react.default.cloneElement(componentPointer, cloneExtensions);\n  } // main render of stepzilla container\n\n\n  return _react.default.createElement(\"div\", {\n    className: \"multi-step\",\n    onKeyDown: function onKeyDown(evt) {\n      handleKeyDown(evt);\n    }\n  }, props.showSteps ? _react.default.createElement(\"ol\", {\n    className: \"progtrckr\"\n  }, renderSteps()) : _react.default.createElement(\"span\", null), compToRender, _react.default.createElement(\"div\", {\n    style: props.showNavigation ? {} : hidden,\n    className: \"footer-buttons\"\n  }, _react.default.createElement(\"button\", {\n    type: \"button\",\n    style: showPreviousBtn ? {} : hidden,\n    className: props.backButtonCls,\n    onClick: function onClick() {\n      previous();\n    },\n    id: \"prev-button\"\n  }, props.backButtonText), _react.default.createElement(\"button\", {\n    type: \"button\",\n    style: showNextBtn ? {} : hidden,\n    className: props.nextButtonCls,\n    onClick: function onClick() {\n      next();\n    },\n    id: \"next-button\"\n  }, nextStepText)));\n}\n\nStepZilla.defaultProps = {\n  showSteps: true,\n  showNavigation: true,\n  stepsNavigation: true,\n  prevBtnOnLastStep: true,\n  dontValidate: false,\n  preventEnterSubmission: false,\n  startAtStep: 0,\n  nextButtonText: 'Next',\n  nextButtonCls: 'btn btn-prev btn-primary btn-lg pull-right',\n  backButtonText: 'Previous',\n  backButtonCls: 'btn btn-next btn-primary btn-lg pull-left',\n  hocValidationAppliedTo: []\n};\nStepZilla.propTypes = {\n  steps: _propTypes.default.arrayOf(_propTypes.default.shape({\n    name: _propTypes.default.oneOfType([_propTypes.default.string, _propTypes.default.object]).isRequired,\n    component: _propTypes.default.element.isRequired\n  })).isRequired,\n  showSteps: _propTypes.default.bool,\n  showNavigation: _propTypes.default.bool,\n  stepsNavigation: _propTypes.default.bool,\n  prevBtnOnLastStep: _propTypes.default.bool,\n  dontValidate: _propTypes.default.bool,\n  preventEnterSubmission: _propTypes.default.bool,\n  startAtStep: _propTypes.default.number,\n  nextButtonText: _propTypes.default.string,\n  nextButtonCls: _propTypes.default.string,\n  backButtonCls: _propTypes.default.string,\n  backButtonText: _propTypes.default.string,\n  hocValidationAppliedTo: _propTypes.default.array,\n  onStepChange: _propTypes.default.func\n};","map":{"version":3,"sources":["/Users/devsmac/Downloads/fx-frontend/node_modules/react-stepzilla/dist/main.js"],"names":["Object","defineProperty","exports","value","default","StepZilla","_react","_interopRequireWildcard","require","_propTypes","_interopRequireDefault","_promise","obj","__esModule","newObj","key","prototype","hasOwnProperty","call","desc","getOwnPropertyDescriptor","get","set","_typeof","Symbol","iterator","constructor","_slicedToArray","arr","i","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","TypeError","_arr","_n","_d","_e","undefined","_i","_s","next","done","push","length","err","Array","isArray","props","_useState","useState","startAtStep","_useState2","compState","setCompState","_useState3","_useState4","navState","setNavState","hidden","display","useEffect","getNavStates","steps","indx","styles","prevBtnOnLastStep","getPrevNextBtnLayout","currentStep","showPreviousBtn","showNextBtn","nextStepText","nextButtonText","nextTextOnFinalActionStep","checkNavState","nextStep","onStepChange","adjustNavState","handleKeyDown","evt","which","preventEnterSubmission","target","type","preventDefault","_jumpToStep","jumpToStep","stepsNavigation","stopPropagation","persist","movingBack","passThroughStepsNotValid","proceed","abstractStepMoveAllowedToPromise","then","valid","updateStepValidationFlag","reduce","a","c","validated","some","catch","e","setTimeout","arguments","previous","val","activeComponentRef","useRef","stepMoveAllowed","skipValidationExecution","dontValidate","isStepAtIndexHOCValidationBased","current","refs","component","isValidated","stepIndex","hocValidationAppliedTo","indexOf","resolve","getClassName","className","liClassName","concat","renderSteps","map","s","createElement","onClick","name","_getPrevNextBtnLayout","cloneExtensions","t","componentPointer","compToRender","Component","ref","cloneElement","onKeyDown","showSteps","style","showNavigation","backButtonCls","id","backButtonText","nextButtonCls","defaultProps","propTypes","arrayOf","shape","oneOfType","string","object","isRequired","element","bool","number","array","func"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = StepZilla;\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _promise = _interopRequireDefault(require(\"promise\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction StepZilla(props) {\n  var _useState = (0, _react.useState)(props.startAtStep),\n      _useState2 = _slicedToArray(_useState, 2),\n      compState = _useState2[0],\n      setCompState = _useState2[1];\n\n  var _useState3 = (0, _react.useState)(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      navState = _useState4[0],\n      setNavState = _useState4[1];\n\n  var hidden = {\n    display: 'none'\n  };\n  (0, _react.useEffect)(function () {\n    setNavState(getNavStates(props.startAtStep, props.steps.length));\n  }, []); // update the header nav states via classes so they can be styled via css\n\n  var getNavStates = function getNavStates(indx, length) {\n    var styles = [];\n\n    for (var i = 0; i < length; i++) {\n      if (i < indx || !props.prevBtnOnLastStep && indx === length - 1) {\n        styles.push('done');\n      } else if (i === indx) {\n        styles.push('doing');\n      } else {\n        styles.push('todo');\n      }\n    }\n\n    return {\n      styles: styles\n    };\n  };\n\n  var getPrevNextBtnLayout = function getPrevNextBtnLayout(currentStep) {\n    // first set default values\n    var showPreviousBtn = true;\n    var showNextBtn = true;\n    var nextStepText = props.nextButtonText; // first step hide previous btn\n\n    if (currentStep === 0) {\n      showPreviousBtn = false;\n    } // second to last step change next btn text if supplied as props\n\n\n    if (currentStep === props.steps.length - 2) {\n      // if user did not give a custom nextTextOnFinalActionStep, the nextButtonText becomes the default\n      var nextTextOnFinalActionStep = props.nextTextOnFinalActionStep ? props.nextTextOnFinalActionStep : props.nextButtonText;\n      nextStepText = nextTextOnFinalActionStep || nextStepText;\n    } // last step hide next btn, hide previous btn if supplied as props\n\n\n    if (currentStep >= props.steps.length - 1) {\n      showNextBtn = false;\n      showPreviousBtn = props.prevBtnOnLastStep === false ? false : true;\n    }\n\n    return {\n      showPreviousBtn: showPreviousBtn,\n      showNextBtn: showNextBtn,\n      nextStepText: nextStepText\n    };\n  }; // which step are we in?\n\n\n  var checkNavState = function checkNavState(nextStep) {\n    if (props.onStepChange) {\n      props.onStepChange(nextStep);\n    }\n  }; // set the nav state\n\n\n  var adjustNavState = function adjustNavState(next) {\n    setNavState(getNavStates(next, props.steps.length));\n\n    if (next < props.steps.length) {\n      setCompState(next);\n    }\n\n    checkNavState(next);\n  }; // handles keydown on enter being pressed in any Child component input area. in this case it goes to the next (ignore textareas as they should allow line breaks)\n\n\n  var handleKeyDown = function handleKeyDown(evt) {\n    if (evt.which === 13) {\n      if (!props.preventEnterSubmission && evt.target.type !== 'textarea') {\n        next();\n      } else if (evt.target.type !== 'textarea') {\n        evt.preventDefault();\n      }\n    }\n  }; // this utility method lets Child components invoke a direct jump to another step\n\n\n  var _jumpToStep = function jumpToStep(evt) {\n    if (typeof evt.target === 'undefined') {\n      // a child step wants to invoke a jump between steps. in this case 'evt' is the numeric step number and not the JS event\n      adjustNavState(evt);\n    } else {\n      // the main navigation step ui is invoking a jump between steps\n      // if stepsNavigation is turned off or user clicked on existing step again (on step 2 and clicked on 2 again) then ignore\n      if (!props.stepsNavigation || evt.target.value === compState) {\n        evt.preventDefault();\n        evt.stopPropagation();\n        return;\n      } // evt is a react event so we need to persist it as we deal with aync promises which nullifies these events (https://facebook.github.io/react/docs/events.html#event-pooling)\n\n\n      evt.persist();\n      var movingBack = evt.target.value < compState; // are we trying to move back or front?\n\n      var passThroughStepsNotValid = false; // if we are jumping forward, only allow that if inbetween steps are all validated. This flag informs the logic...\n\n      var proceed = false; // flag on if we should move on\n\n      abstractStepMoveAllowedToPromise(movingBack).then(function (valid) {\n        // validation was a success (promise or sync validation). In it was a Promise's resolve()\n        // ... then proceed will be undefined, so make it true. Or else 'proceed' will carry the true/false value from sync\n        proceed = typeof valid === 'undefined' ? true : valid;\n\n        if (!movingBack) {\n          updateStepValidationFlag(proceed);\n        }\n\n        if (proceed) {\n          if (!movingBack) {\n            // looks like we are moving forward, 'reduce' a new array of step>validated values we need to check and\n            // ... 'some' that to get a decision on if we should allow moving forward\n            passThroughStepsNotValid = props.steps.reduce(function (a, c, i) {\n              if (i >= compState && i < evt.target.value) {\n                a.push(c.validated);\n              }\n\n              return a;\n            }, []).some(function (c) {\n              return c === false;\n            });\n          }\n        }\n      }).catch(function () {\n        // Promise based validation was a fail (i.e reject())\n        if (!movingBack) {\n          updateStepValidationFlag(false);\n        }\n      }).then(function () {\n        // this is like finally(), executes if error no no error\n        if (proceed && !passThroughStepsNotValid) {\n          if (evt.target.value === props.steps.length - 1 && compState === props.steps.length - 1) {\n            adjustNavState(props.steps.length);\n          } else {\n            adjustNavState(evt.target.value);\n          }\n        }\n      }).catch(function (e) {\n        if (e) {\n          // see note below called \"CatchRethrowing\"\n          // ... plus the finally then() above is what throws the JS Error so we need to catch that here specifically\n          setTimeout(function () {\n            throw e;\n          });\n        }\n      });\n    }\n  }; // move next via next button\n\n\n  var next = function next() {\n    abstractStepMoveAllowedToPromise().then(function () {\n      var proceed = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n      // validation was a success (promise or sync validation). In it was a Promise's resolve() then proceed will be undefined,\n      // ... so make it true. Or else 'proceed' will carry the true/false value from sync validation\n      updateStepValidationFlag(proceed);\n\n      if (proceed) {\n        adjustNavState(compState + 1);\n      }\n    }).catch(function (e) {\n      if (e) {\n        // CatchRethrowing: as we wrap StepMoveAllowed() to resolve as a Promise, the then() is invoked and the next React Component is loaded.\n        // ... during the render, if there are JS errors thrown (e.g. ReferenceError) it gets swallowed by the Promise library and comes in here (catch)\n        // ... so we need to rethrow it outside the execution stack so it behaves like a notmal JS error (i.e. halts and prints to console)\n        //\n        setTimeout(function () {\n          throw e;\n        });\n      } // Promise based validation was a fail (i.e reject())\n\n\n      updateStepValidationFlag(false);\n    });\n  }; // move behind via previous button\n\n\n  var previous = function previous() {\n    if (compState > 0) {\n      adjustNavState(compState - 1);\n    }\n  }; // update step's validation flag\n\n\n  var updateStepValidationFlag = function updateStepValidationFlag() {\n    var val = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n    props.steps[compState].validated = val; // note: if a step component returns 'underfined' then treat as \"true\".\n  };\n\n  var activeComponentRef = (0, _react.useRef)(null); // are we allowed to move forward? via the next button or via jumpToStep?\n\n  var stepMoveAllowed = function stepMoveAllowed() {\n    var skipValidationExecution = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n    var proceed = false;\n\n    if (props.dontValidate) {\n      proceed = true;\n    } else {\n      if (skipValidationExecution) {\n        // we are moving backwards in steps, in this case dont validate as it means the user is not commiting to \"save\"\n        proceed = true;\n      } else if (isStepAtIndexHOCValidationBased(compState)) {\n        // the user is using a higer order component (HOC) for validation (e.g react-validation-mixin), this wraps the StepZilla steps as a HOC,\n        // so use hocValidationAppliedTo to determine if this step needs the aync validation as per react-validation-mixin interface\n        proceed = activeComponentRef.current.refs.component.isValidated();\n      } else if (activeComponentRef.current === null || typeof activeComponentRef.current.isValidated === 'undefined') {\n        // if its a form component, it should have implemeted a public isValidated class (also pure componenets wont even have refs - i.e. a empty object). If not then continue\n        proceed = true;\n      } else {\n        // user is moving forward in steps, invoke validation as its available\n        proceed = activeComponentRef.current.isValidated();\n      }\n    }\n\n    return proceed;\n  };\n\n  var isStepAtIndexHOCValidationBased = function isStepAtIndexHOCValidationBased(stepIndex) {\n    return props.hocValidationAppliedTo && props.hocValidationAppliedTo.length > 0 && props.hocValidationAppliedTo.indexOf(stepIndex) > -1;\n  }; // a validation method is each step can be sync or async (Promise based), this utility abstracts the wrapper stepMoveAllowed to be Promise driven regardless of validation return type\n\n\n  var abstractStepMoveAllowedToPromise = function abstractStepMoveAllowedToPromise(movingBack) {\n    return _promise.default.resolve(stepMoveAllowed(movingBack));\n  }; // get the classmame of steps\n\n\n  var getClassName = function getClassName(className, i) {\n    var liClassName = '';\n\n    if (navState && navState.styles) {\n      liClassName = \"\".concat(className, \"-\").concat(navState.styles[i]); // if step ui based navigation is disabled, then dont highlight step\n\n      if (!props.stepsNavigation) {\n        liClassName += ' no-hl';\n      }\n    }\n\n    return liClassName;\n  }; // render the steps as stepsNavigation\n\n\n  var renderSteps = function renderSteps() {\n    return props.steps.map(function (s, i) {\n      return _react.default.createElement(\"li\", {\n        className: getClassName('progtrckr', i),\n        onClick: function onClick(evt) {\n          _jumpToStep(evt);\n        },\n        key: i,\n        value: i\n      }, _react.default.createElement(\"em\", null, i + 1), _react.default.createElement(\"span\", null, props.steps[i].name));\n    });\n  };\n\n  var _getPrevNextBtnLayout = getPrevNextBtnLayout(compState),\n      nextStepText = _getPrevNextBtnLayout.nextStepText,\n      showNextBtn = _getPrevNextBtnLayout.showNextBtn,\n      showPreviousBtn = _getPrevNextBtnLayout.showPreviousBtn; // clone the step component dynamically and tag it as activeComponent so we can validate it on next. also bind the jumpToStep piping method\n\n\n  var cloneExtensions = {\n    jumpToStep: function jumpToStep(t) {\n      _jumpToStep(t);\n    }\n  };\n  var componentPointer = null;\n  var compToRender = null;\n\n  if (props.steps[compState]) {\n    componentPointer = props.steps[compState].component; // S: ref binding -----\n    // we need to bind a ref to it so we can use the imperitive \"isValidated\" method when needed to prevent navigation\n    // ... we only can do this if its a (1) React Class based component or (2) A Hooks based stateful component wrapped in forwardRef\n    // (1) can only update refs if its a regular React component (not a pure component - i.e. function components with no state), so lets check that\n\n    if (componentPointer instanceof _react.Component || componentPointer.type && componentPointer.type.prototype instanceof _react.Component) {\n      // unit test deteceted that instanceof Component can be in either of these locations so test both (not sure why this is the case)\n      cloneExtensions.ref = activeComponentRef;\n    } else {\n      // (2) after react hooks was released, functional components can have state and therefore support refs\n      // ... we do this via forwardRefs. So we need to support this as well\n      // ... after testing, if both the below types are objects then it's a hooks function component wrapped in forwardRef\n      if (_typeof(componentPointer) === 'object' && _typeof(componentPointer.type) === 'object') {\n        cloneExtensions.ref = activeComponentRef;\n      }\n    } // E: ref binding -----\n\n\n    compToRender = _react.default.cloneElement(componentPointer, cloneExtensions);\n  } // main render of stepzilla container\n\n\n  return _react.default.createElement(\"div\", {\n    className: \"multi-step\",\n    onKeyDown: function onKeyDown(evt) {\n      handleKeyDown(evt);\n    }\n  }, props.showSteps ? _react.default.createElement(\"ol\", {\n    className: \"progtrckr\"\n  }, renderSteps()) : _react.default.createElement(\"span\", null), compToRender, _react.default.createElement(\"div\", {\n    style: props.showNavigation ? {} : hidden,\n    className: \"footer-buttons\"\n  }, _react.default.createElement(\"button\", {\n    type: \"button\",\n    style: showPreviousBtn ? {} : hidden,\n    className: props.backButtonCls,\n    onClick: function onClick() {\n      previous();\n    },\n    id: \"prev-button\"\n  }, props.backButtonText), _react.default.createElement(\"button\", {\n    type: \"button\",\n    style: showNextBtn ? {} : hidden,\n    className: props.nextButtonCls,\n    onClick: function onClick() {\n      next();\n    },\n    id: \"next-button\"\n  }, nextStepText)));\n}\n\nStepZilla.defaultProps = {\n  showSteps: true,\n  showNavigation: true,\n  stepsNavigation: true,\n  prevBtnOnLastStep: true,\n  dontValidate: false,\n  preventEnterSubmission: false,\n  startAtStep: 0,\n  nextButtonText: 'Next',\n  nextButtonCls: 'btn btn-prev btn-primary btn-lg pull-right',\n  backButtonText: 'Previous',\n  backButtonCls: 'btn btn-next btn-primary btn-lg pull-left',\n  hocValidationAppliedTo: []\n};\nStepZilla.propTypes = {\n  steps: _propTypes.default.arrayOf(_propTypes.default.shape({\n    name: _propTypes.default.oneOfType([_propTypes.default.string, _propTypes.default.object]).isRequired,\n    component: _propTypes.default.element.isRequired\n  })).isRequired,\n  showSteps: _propTypes.default.bool,\n  showNavigation: _propTypes.default.bool,\n  stepsNavigation: _propTypes.default.bool,\n  prevBtnOnLastStep: _propTypes.default.bool,\n  dontValidate: _propTypes.default.bool,\n  preventEnterSubmission: _propTypes.default.bool,\n  startAtStep: _propTypes.default.number,\n  nextButtonText: _propTypes.default.string,\n  nextButtonCls: _propTypes.default.string,\n  backButtonCls: _propTypes.default.string,\n  backButtonText: _propTypes.default.string,\n  hocValidationAppliedTo: _propTypes.default.array,\n  onStepChange: _propTypes.default.func\n};"]},"metadata":{},"sourceType":"script"}