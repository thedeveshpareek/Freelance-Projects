{"ast":null,"code":"import _slicedToArray from\"/home/codegama/bhawya/source_code/fx-frontend-base/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";var _this=this;import React,{useEffect,useState}from\"react\";import{Form,Button,Image,Modal,Tab,Nav,Row,Col}from\"react-bootstrap\";import{CopyToClipboard}from\"react-copy-to-clipboard\";import{createNotification}from\"react-redux-notify/lib/modules/Notifications\";import{connect}from\"react-redux\";import{translate,t}from\"react-multi-lang\";import configuration from\"react-global-configuration\";import PaypalExpressBtn from\"react-paypal-express-checkout\";import{getSuccessNotificationMessage,getErrorNotificationMessage}from\"../../components/helper/NotificationMessage\";import{livePaymentPaypalStart,livePaymentStripeStart,livePaymentWalletStart}from\"../../store/actions/LiveVideoAction\";import{fetchCardDetailsStart}from\"../../store/actions/CardsAction\";import{fetchWalletDetailsStart}from\"../../store/actions/WalletAction\";import{Link}from\"react-router-dom\";var $=window.$;var PaymentModal=function PaymentModal(props){var _useState=useState(localStorage.getItem(\"default_payment_method\")),_useState2=_slicedToArray(_useState,2),paymentType=_useState2[0],setPaymentType=_useState2[1];useEffect(function(){if(props.paymentModal===true){props.dispatch(fetchCardDetailsStart());props.dispatch(fetchWalletDetailsStart());}},[props.paymentModal]);var handleSubmit=function handleSubmit(event){event.preventDefault();if(paymentType===\"CARD\")props.dispatch(livePaymentStripeStart({live_video_id:props.liveVideo.live_video_id}));if(paymentType===\"wallet\")alert(paymentType);props.dispatch(livePaymentWalletStart({live_video_id:props.liveVideo.live_video_id}));props.closePaymentModal();};var paypalOnSuccess=function paypalOnSuccess(payment){setTimeout(function(){props.dispatch(livePaymentPaypalStart({live_video_id:props.liveVideo.live_video_id,payment_id:payment.paymentID}));},1000);props.closePaymentModal();};var paypalOnError=function paypalOnError(err){var notificationMessage=getErrorNotificationMessage(err);_this.props.dispatch(createNotification(notificationMessage));};var paypalOnCancel=function paypalOnCancel(data){var notificationMessage=getErrorNotificationMessage(\"Payment cancelled please try again..\");_this.props.dispatch(createNotification(notificationMessage));};var env=configuration.get(\"configData.PAYPAL_MODE\");// you can set here to 'production' for production\nvar currency=\"USD\";// or you can set this value from your props or state\nvar client={sandbox:configuration.get(\"configData.PAYPAL_ID\"),production:configuration.get(\"configData.PAYPAL_ID\")};return/*#__PURE__*/React.createElement(Modal,{centered:true,size:\"lg\",className:\"modal-dialog-center sent-tip-modal\",show:props.paymentModal,onHide:props.closePaymentModal},props.paymentModal===true?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Modal.Header,{closeButton:true},/*#__PURE__*/React.createElement(Modal.Title,null,t(\"live_video_payment\"))),/*#__PURE__*/React.createElement(Modal.Body,{className:\"subscription-tip-ppv-tab\"},/*#__PURE__*/React.createElement(Tab.Container,{id:\"left-tabs-example\",defaultActiveKey:paymentType},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{sm:3},/*#__PURE__*/React.createElement(Nav,{variant:\"pills\",className:\"flex-column\"},configuration.get(\"configData.is_stripe_enabled\")==1&&configuration.get(\"configData.stripe_publishable_key\")!==\"\"&&configuration.get(\"configData.stripe_secret_key\")!==\"\"?/*#__PURE__*/React.createElement(Nav.Item,null,/*#__PURE__*/React.createElement(Nav.Link,{onClick:function onClick(){return setPaymentType(\"CARD\");},eventKey:\"CARD\"},t('card_stripe'))):null,configuration.get(\"configData.is_paypal_enabled\")==1&&configuration.get(\"configData.PAYPAL_ID\")!==\"\"?/*#__PURE__*/React.createElement(Nav.Item,null,/*#__PURE__*/React.createElement(Nav.Link,{onClick:function onClick(){return setPaymentType(\"PAYPAL\");},eventKey:\"PAYPAL\"},t('paypal'))):null,configuration.get(\"configData.is_ccbill_enabled\")==1&&configuration.get(\"configData.flex_form_id\")!==\"\"&&configuration.get(\"configData.salt_key\")!==\"\"?/*#__PURE__*/React.createElement(Nav.Item,null,/*#__PURE__*/React.createElement(Nav.Link,{onClick:function onClick(){return setPaymentType(\"CCBILL\");},eventKey:\"CCBILL\"},t('ccbill'))):null,configuration.get(\"configData.is_wallet_payment_enabled\")==1?/*#__PURE__*/React.createElement(Nav.Item,null,/*#__PURE__*/React.createElement(Nav.Link,{onClick:function onClick(){return setPaymentType(\"WALLET\");},eventKey:\"WALLET\"},t('wallet'))):null)),/*#__PURE__*/React.createElement(Col,{sm:9},/*#__PURE__*/React.createElement(\"div\",{className:\"card-stripe-box\"},/*#__PURE__*/React.createElement(Form,null,/*#__PURE__*/React.createElement(Form.Group,{className:\"mb-3\",controlId:\"exampleForm.ControlInput1\"},/*#__PURE__*/React.createElement(Form.Control,{type:\"text\",placeholder:t(\"pay_amount\"),value:props.liveVideo.amount_formatted,disabled:true})),/*#__PURE__*/React.createElement(Tab.Content,null,configuration.get(\"configData.is_stripe_enabled\")==1&&configuration.get(\"configData.stripe_publishable_key\")!==\"\"&&configuration.get(\"configData.stripe_secret_key\")!==\"\"?/*#__PURE__*/React.createElement(Tab.Pane,{eventKey:\"CARD\"},/*#__PURE__*/React.createElement(\"div\",{className:\"card-stripe-sec\"},props.cards.loading?\"\":props.cards.data.cards.length>0?props.cards.data.cards.map(function(card){return card.is_default==1&&/*#__PURE__*/React.createElement(\"div\",{className:\"card-stripe-list-box\"},/*#__PURE__*/React.createElement(\"h5\",{className:\"mb-3\"},\"XXXX XXXX XXXX \",card.last_four),/*#__PURE__*/React.createElement(\"h5\",{className:\"text-muted\"},card.card_type),/*#__PURE__*/React.createElement(\"div\",{className:\"card-stripe-bottom\"},/*#__PURE__*/React.createElement(\"div\",{className:\"card-stripe-action-btn\"},/*#__PURE__*/React.createElement(\"p\",{className:\"card-link-text text-success\"},t(\"default_card\")))));}):/*#__PURE__*/React.createElement(\"div\",{className:\"card-stripe-item\"},/*#__PURE__*/React.createElement(Link,{to:\"cards\"},/*#__PURE__*/React.createElement(\"div\",{className:\"add-account-item\"},/*#__PURE__*/React.createElement(Image,{className:\"add-account-icon\",src:window.location.origin+\"/assets/images/icons/new/add-card.svg\"}),/*#__PURE__*/React.createElement(\"h5\",{className:\"text-muted\"},\"Add Card\")))))):null,configuration.get(\"configData.is_wallet_payment_enabled\")==1?/*#__PURE__*/React.createElement(Tab.Pane,{eventKey:\"WALLET\"},props.wallet.loading?\"\":/*#__PURE__*/React.createElement(\"div\",{className:\"card-stripe-box\"},/*#__PURE__*/React.createElement(\"div\",{className:\"wallet-balence-amount\"},/*#__PURE__*/React.createElement(\"h4\",null,t('available')),/*#__PURE__*/React.createElement(\"p\",null,props.wallet.data.user_wallet.remaining_formatted)),props.liveVideo.amount>props.wallet.data.user_wallet.remaining?/*#__PURE__*/React.createElement(\"div\",{className:\"\"},/*#__PURE__*/React.createElement(\"p\",{className:\"conv-desc desc\"},t('low_wallet_balance_tips_payment_para')),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex\"},/*#__PURE__*/React.createElement(Link,{to:\"/wallet\",className:\"withdraw-money-btn\"},t('add_wallet_amount')))):null)):null))))))),/*#__PURE__*/React.createElement(Modal.Footer,null,paymentType===\"PAYPAL\"&&props.liveVideo.amount!=0?/*#__PURE__*/React.createElement(PaypalExpressBtn,{env:env,client:client,currency:currency,total:props.liveVideo.amount,onError:paypalOnError,onSuccess:paypalOnSuccess,onCancel:paypalOnCancel}):null,/*#__PURE__*/React.createElement(Button,{type:\"button\",className:\"btn btn-danger\",\"data-dismiss\":\"modal\",onClick:props.closePaymentModal},t(\"cancel\")),paymentType!==\"PAYPAL\"?/*#__PURE__*/React.createElement(Button,{type:\"button\",className:\"btn btn-success\",\"data-dismiss\":\"modal\",onClick:handleSubmit,disabled:props.liveVideoDetails.buttonDisable},props.liveVideoDetails.loadingButtonContent!==null?props.liveVideoDetails.loadingButtonContent:t(\"pay\")):null)):null);};var mapStateToPros=function mapStateToPros(state){return{liveVideoDetails:state.liveVideo.singleLiveVideo,wallet:state.wallet.walletData,cards:state.cards.cardDetails};};function mapDispatchToProps(dispatch){return{dispatch:dispatch};}export default connect(mapStateToPros,mapDispatchToProps)(translate(PaymentModal));","map":{"version":3,"sources":["/home/codegama/bhawya/source_code/fx-frontend-base/src/components/LiveVideos/PaymentModal.jsx"],"names":["React","useEffect","useState","Form","Button","Image","Modal","Tab","Nav","Row","Col","CopyToClipboard","createNotification","connect","translate","t","configuration","PaypalExpressBtn","getSuccessNotificationMessage","getErrorNotificationMessage","livePaymentPaypalStart","livePaymentStripeStart","livePaymentWalletStart","fetchCardDetailsStart","fetchWalletDetailsStart","Link","$","window","PaymentModal","props","localStorage","getItem","paymentType","setPaymentType","paymentModal","dispatch","handleSubmit","event","preventDefault","live_video_id","liveVideo","alert","closePaymentModal","paypalOnSuccess","payment","setTimeout","payment_id","paymentID","paypalOnError","err","notificationMessage","paypalOnCancel","data","env","get","currency","client","sandbox","production","amount_formatted","cards","loading","length","map","card","is_default","last_four","card_type","location","origin","wallet","user_wallet","remaining_formatted","amount","remaining","liveVideoDetails","buttonDisable","loadingButtonContent","mapStateToPros","state","singleLiveVideo","walletData","cardDetails","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { Form, Button, Image, Modal, Tab, Nav, Row, Col } from \"react-bootstrap\";\nimport { CopyToClipboard } from \"react-copy-to-clipboard\";\nimport { createNotification } from \"react-redux-notify/lib/modules/Notifications\";\nimport { connect } from \"react-redux\";\nimport { translate, t } from \"react-multi-lang\";\nimport configuration from \"react-global-configuration\";\nimport PaypalExpressBtn from \"react-paypal-express-checkout\";\nimport {\n    getSuccessNotificationMessage,\n    getErrorNotificationMessage,\n} from \"../../components/helper/NotificationMessage\";\nimport {\n    livePaymentPaypalStart,\n    livePaymentStripeStart,\n    livePaymentWalletStart,\n} from \"../../store/actions/LiveVideoAction\";\nimport {\n  fetchCardDetailsStart,\n} from \"../../store/actions/CardsAction\";\nimport { fetchWalletDetailsStart } from \"../../store/actions/WalletAction\";\nimport { Link } from \"react-router-dom\";\nconst $ = window.$;\n\nconst PaymentModal = (props) => {\n\n    const [paymentType, setPaymentType] = useState(localStorage.getItem(\"default_payment_method\"));\n\n    useEffect(() => {\n      if (props.paymentModal === true) {\n        props.dispatch(fetchCardDetailsStart());\n        props.dispatch(fetchWalletDetailsStart());\n      }\n      \n    }, [props.paymentModal]);\n\n    const handleSubmit = (event) => {\n        event.preventDefault();\n        if (paymentType === \"CARD\")\n          props.dispatch(\n            livePaymentStripeStart({\n                live_video_id:props.liveVideo.live_video_id,\n            })\n          );\n        if (paymentType === \"wallet\")\n        alert(paymentType);\n          props.dispatch(\n            livePaymentWalletStart({\n                live_video_id:props.liveVideo.live_video_id,\n            })\n          );\n        props.closePaymentModal();\n    };\n\n    const paypalOnSuccess = (payment) => {\n        setTimeout(() => {\n          props.dispatch(\n            livePaymentPaypalStart({\n                live_video_id:props.liveVideo.live_video_id,\n                payment_id: payment.paymentID,\n            })\n          );\n        }, 1000);\n        props.closePaymentModal();\n    };\n    \n    const paypalOnError = (err) => {\n        const notificationMessage = getErrorNotificationMessage(err);\n        this.props.dispatch(createNotification(notificationMessage));\n    };\n    \n    const paypalOnCancel = (data) => {\n        const notificationMessage = getErrorNotificationMessage(\n          \"Payment cancelled please try again..\"\n        );\n        this.props.dispatch(createNotification(notificationMessage));\n    };\n    let env = configuration.get(\"configData.PAYPAL_MODE\"); // you can set here to 'production' for production\n    let currency = \"USD\"; // or you can set this value from your props or state\n\n    const client = {\n        sandbox: configuration.get(\"configData.PAYPAL_ID\"),\n        production: configuration.get(\"configData.PAYPAL_ID\"),\n    };\n\n    return (\n      <Modal centered\n      size=\"lg\"\n      className=\"modal-dialog-center sent-tip-modal\"\n      show={props.paymentModal}\n      onHide={props.closePaymentModal}\n    >\n      {props.paymentModal === true ? \n      <>\n      <Modal.Header closeButton>\n          <Modal.Title>{t(\"live_video_payment\")}</Modal.Title>\n      </Modal.Header>\n      <Modal.Body className=\"subscription-tip-ppv-tab\">\n          <Tab.Container id=\"left-tabs-example\" defaultActiveKey={paymentType}>\n              <Row>\n                  <Col sm={3}>\n                      <Nav variant=\"pills\" className=\"flex-column\">\n                        {configuration.get(\"configData.is_stripe_enabled\") ==\n                          1 && configuration.get(\"configData.stripe_publishable_key\") !== \"\" && configuration.get(\"configData.stripe_secret_key\") !== \"\" ? (\n                          <Nav.Item>\n                              <Nav.Link onClick={() => setPaymentType(\"CARD\")} eventKey=\"CARD\">{t('card_stripe')}</Nav.Link>\n                          </Nav.Item>\n                          ) : null}\n                          {configuration.get(\"configData.is_paypal_enabled\") ==\n                            1  && configuration.get(\"configData.PAYPAL_ID\") !== \"\" ? (\n                            <Nav.Item>\n                                <Nav.Link onClick={() => setPaymentType(\"PAYPAL\")} eventKey=\"PAYPAL\">{t('paypal')}</Nav.Link>\n                            </Nav.Item>\n                          ) : null}\n                          {configuration.get(\"configData.is_ccbill_enabled\") ==\n                            1 && configuration.get(\"configData.flex_form_id\") !== \"\" && configuration.get(\"configData.salt_key\") !== \"\" ? (\n                          <Nav.Item>\n                              <Nav.Link onClick={() => setPaymentType(\"CCBILL\")} eventKey=\"CCBILL\">{t('ccbill')}</Nav.Link>\n                          </Nav.Item>\n                          ) : null}\n                          {configuration.get(\"configData.is_wallet_payment_enabled\") ==\n                            1 ? (\n                          <Nav.Item>\n                              <Nav.Link onClick={() => setPaymentType(\"WALLET\")} eventKey=\"WALLET\">{t('wallet')}</Nav.Link>\n                          </Nav.Item>\n                          ) : null}\n                      </Nav>\n                  </Col>\n                  <Col sm={9}>\n                    <div className=\"card-stripe-box\">\n                      <Form>\n                        <Form.Group className=\"mb-3\" controlId=\"exampleForm.ControlInput1\">\n                            <Form.Control type=\"text\" \n                              placeholder={t(\"pay_amount\")} \n                              value={props.liveVideo.amount_formatted}\n                              disabled/>\n                        </Form.Group>\n                        <Tab.Content>\n                        \n                          {configuration.get(\"configData.is_stripe_enabled\") ==\n                            1 && configuration.get(\"configData.stripe_publishable_key\") !== \"\" && configuration.get(\"configData.stripe_secret_key\") !== \"\" ? (\n                              <Tab.Pane eventKey=\"CARD\">\n                                <div className=\"card-stripe-sec\">\n                                  {props.cards.loading ? \"\" : props.cards.data.cards.length > 0 ?\n                                  props.cards.data.cards.map((card) => ( (\n                                    card.is_default == 1 && (\n                                    <div className=\"card-stripe-list-box\">\n                                        <h5 className=\"mb-3\">XXXX XXXX XXXX {card.last_four}</h5>\n                                        <h5 className=\"text-muted\">{card.card_type}</h5>\n                                        <div className=\"card-stripe-bottom\">\n                                            <div className=\"card-stripe-action-btn\">\n                                                <p className=\"card-link-text text-success\">{t(\"default_card\")}</p>\n                                            </div>\n                                        </div>\n                                      </div> )\n                                  ))): (\n                                    <div className=\"card-stripe-item\">\n                                      <Link to=\"cards\">\n                                        <div className=\"add-account-item\">\n                                            <Image\n                                                className=\"add-account-icon\"\n                                                src={\n                                                    window.location.origin + \"/assets/images/icons/new/add-card.svg\"\n                                                }\n                                            />\n                                            <h5 className=\"text-muted\">Add Card</h5>\n                                        </div>\n                                      </Link>\n                                    </div>\n                                  )}\n                                </div>\n                              </Tab.Pane>\n                            ) : null}\n\n                          {configuration.get(\"configData.is_wallet_payment_enabled\") ==\n                            1 ? (\n                            <Tab.Pane eventKey=\"WALLET\">\n                              {props.wallet.loading ? \"\" : (\n                                <div className=\"card-stripe-box\">\n                                  <div className=\"wallet-balence-amount\">\n                                      <h4>{t('available')}</h4>\n                                      <p>{props.wallet.data.user_wallet.remaining_formatted}</p>\n                                  </div>\n                                  {props.liveVideo.amount > props.wallet.data.user_wallet.remaining ? (\n                                    <div className=\"\">\n                                        <p className=\"conv-desc desc\">{t('low_wallet_balance_tips_payment_para')}</p>\n                                        <div className=\"d-flex\">\n                                          <Link to=\"/wallet\" className=\"withdraw-money-btn\">{t('add_wallet_amount')}</Link>\n                                        </div>\n                                    </div>\n                                  ) : null}\n                                </div>\n                              )}\n                            </Tab.Pane>\n                          ) : null}\n\n                        </Tab.Content>\n                      </Form>\n                    </div>\n                  </Col>\n              </Row>\n          </Tab.Container>\n      </Modal.Body>\n      <Modal.Footer>\n        {paymentType === \"PAYPAL\" && props.liveVideo.amount != 0 ? (\n          <PaypalExpressBtn\n            env={env}\n            client={client}\n            currency={currency}\n            total={props.liveVideo.amount}\n            onError={paypalOnError}\n            onSuccess={paypalOnSuccess}\n            onCancel={paypalOnCancel}\n          />\n        ) : null}\n          <Button\n              type=\"button\"\n              className=\"btn btn-danger\"\n              data-dismiss=\"modal\"\n              onClick={props.closePaymentModal}\n          >\n              {t(\"cancel\")}\n          </Button>\n          {paymentType !== \"PAYPAL\" ? (\n          <Button\n              type=\"button\"\n              className=\"btn btn-success\"\n              data-dismiss=\"modal\"\n              onClick={handleSubmit}\n              disabled={props.liveVideoDetails.buttonDisable}\n          >\n              {props.liveVideoDetails.loadingButtonContent !== null\n                    ? props.liveVideoDetails.loadingButtonContent\n                    : t(\"pay\")}\n          </Button>\n          ) : null}\n      </Modal.Footer>\n      </>\n      : null}\n  </Modal>\n   );\n};\n\n\nconst mapStateToPros = (state) => ({\n    liveVideoDetails: state.liveVideo.singleLiveVideo,\n    wallet: state.wallet.walletData,\n    cards: state.cards.cardDetails,\n});\n\nfunction mapDispatchToProps(dispatch) {\n  return { dispatch };\n}\n\nexport default connect(\n    mapStateToPros,\n    mapDispatchToProps\n  )(translate(PaymentModal));"]},"metadata":{},"sourceType":"module"}