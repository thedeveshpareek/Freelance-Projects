{"ast":null,"code":"import _regeneratorRuntime from\"/home/codegama/bhawya/source_code/fx-frontend-base/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _slicedToArray from\"/home/codegama/bhawya/source_code/fx-frontend-base/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _asyncToGenerator from\"/home/codegama/bhawya/source_code/fx-frontend-base/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React,{useEffect,useState}from\"react\";import{connect}from\"react-redux\";import{translate,t}from\"react-multi-lang\";import AgoraRTC from\"agora-rtc-sdk-ng\";import{Form,Button,Container,Row,Col,Table,Media,Image}from\"react-bootstrap\";import{endVideoCallStart,fetchSingleVideoCallStart,joinVideoCallStart}from\"../../store/actions/PrivateCallAction\";import configuration from\"react-global-configuration\";import{Link}from\"react-router-dom\";var client=AgoraRTC.createClient({mode:\"live\",codec:\"vp8\"});var $=window.$;var AgoraOnetoOne=function AgoraOnetoOne(props){var rtc={// For the local client.\nclient:null,// For the local audio and video tracks.\nlocalAudioTrack:null,localVideoTrack:null};var localTracks={videoTrack:null,audioTrack:null};var localTrackState={videoTrackEnabled:true,audioTrackEnabled:true};var options={// Pass your app ID here.\nappId:configuration.get(\"configData.agora_app_id\"),// Set the channel name.\nchannel:\"demo_channel_name\",// Pass a token if your project enables the App Certificate.\ntoken:null,uid:null};var remoteUsers={};function startBasicCall(){return _startBasicCall.apply(this,arguments);}function _startBasicCall(){_startBasicCall=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$Promise$all,_yield$Promise$all2;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:rtc.client=AgoraRTC.createClient({mode:\"rtc\",codec:\"vp8\"});rtc.client.on(\"user-published\",handleUserPublished);rtc.client.on(\"user-unpublished\",handleUserUnpublished);_context.t0=Promise;_context.next=6;return rtc.client.join(options.appId,options.channel,options.token,null);case 6:_context.t1=_context.sent;_context.next=9;return AgoraRTC.createMicrophoneAudioTrack();case 9:_context.t2=rtc.localAudioTrack=_context.sent;_context.next=12;return AgoraRTC.createCameraVideoTrack();case 12:_context.t3=rtc.localVideoTrack=_context.sent;_context.t4=[_context.t1,_context.t2,_context.t3];_context.next=16;return _context.t0.all.call(_context.t0,_context.t4);case 16:_yield$Promise$all=_context.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,3);options.uid=_yield$Promise$all2[0];localTracks.audioTrack=_yield$Promise$all2[1];localTracks.videoTrack=_yield$Promise$all2[2];localTracks.videoTrack.play(\"local-player\");_context.next=24;return rtc.client.publish(Object.values(localTracks));case 24:// Publish the local audio and video tracks to the channel.\n// await rtc.client.publish([rtc.localAudioTrack, rtc.localVideoTrack]);\nconsole.log(\"publish success!\");props.dispatch(joinVideoCallStart({video_call_request_id:props.videoCallData.video_call_request_id}));case 26:case\"end\":return _context.stop();}}},_callee);}));return _startBasicCall.apply(this,arguments);}function subscribe(_x,_x2){return _subscribe.apply(this,arguments);}function _subscribe(){_subscribe=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(user,mediaType){var uid,remoteVideoTrack;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:uid=user.uid;// subscribe to a remote user\n_context2.next=3;return rtc.client.subscribe(user,mediaType);case 3:console.log(\"subscribe success\");if(mediaType==='video'){remoteVideoTrack=user.videoTrack;remoteVideoTrack.play(\"remote-playerlist\");}if(mediaType==='audio'){user.audioTrack.play();}case 6:case\"end\":return _context2.stop();}}},_callee2);}));return _subscribe.apply(this,arguments);}function handleUserPublished(user,mediaType){var id=user.uid;remoteUsers[id]=user;subscribe(user,mediaType);}function handleUserUnpublished(user){// const id = user.uid;\n// delete remoteUsers[id];\n// $(`#player-wrapper-${id}`).remove();\n}startBasicCall();function leaveCall(_x3){return _leaveCall.apply(this,arguments);}function _leaveCall(){_leaveCall=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(is_owner){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!is_owner){_context3.next=7;break;}// Destroy the local audio and video tracks.\nrtc.localAudioTrack.close();rtc.localVideoTrack.close();// Traverse all remote users.\nrtc.client.remoteUsers.forEach(function(user){// Destroy the dynamically created DIV container.\nvar playerContainer=document.getElementById(user.uid);playerContainer&&playerContainer.remove();});props.dispatch(endVideoCallStart({video_call_request_id:props.videoCallData.video_call_request_id}));_context3.next=9;break;case 7:_context3.next=9;return rtc.client.leave();case 9:window.location.assign(\"/video-calls-history\");case 10:case\"end\":return _context3.stop();}}},_callee3);}));return _leaveCall.apply(this,arguments);}function muteAudio(){return _muteAudio.apply(this,arguments);}function _muteAudio(){_muteAudio=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(rtc.localAudioTrack){_context4.next=2;break;}return _context4.abrupt(\"return\");case 2:if(!(localTrackState.audioTrackEnabled==true)){_context4.next=10;break;}_context4.next=5;return rtc.localAudioTrack.setEnabled(false);case 5:localTrackState.audioTrackEnabled=false;$(\"#mute-audio\").hide();$(\"#unmute-audio\").show();_context4.next=15;break;case 10:_context4.next=12;return rtc.localAudioTrack.setEnabled(true);case 12:localTrackState.audioTrackEnabled=true;$(\"#mute-audio\").show();$(\"#unmute-audio\").hide();case 15:case\"end\":return _context4.stop();}}},_callee4);}));return _muteAudio.apply(this,arguments);}function muteVideo(){return _muteVideo.apply(this,arguments);}function _muteVideo(){_muteVideo=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(rtc.localVideoTrack){_context5.next=2;break;}return _context5.abrupt(\"return\");case 2:if(!(localTrackState.videoTrackEnabled==true)){_context5.next=10;break;}_context5.next=5;return rtc.localVideoTrack.setEnabled(false);case 5:localTrackState.videoTrackEnabled=false;$(\"#mute-video\").hide();$(\"#unmute-video\").show();_context5.next=15;break;case 10:_context5.next=12;return rtc.localVideoTrack.setEnabled(true);case 12:localTrackState.videoTrackEnabled=true;$(\"#mute-video\").show();$(\"#unmute-video\").hide();case 15:case\"end\":return _context5.stop();}}},_callee5);}));return _muteVideo.apply(this,arguments);}console.log(props.isOwner);return/*#__PURE__*/React.createElement(\"div\",{className:\"agora-card\"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Col,{sm:12,xs:12,md:3},/*#__PURE__*/React.createElement(\"div\",{id:\"local-player\",style:{width:\"280px\",height:\"400px\"}})),/*#__PURE__*/React.createElement(Col,{sm:12,xs:12,md:9},/*#__PURE__*/React.createElement(\"div\",{id:\"remote-playerlist\",style:{width:\"825px\",height:\"400px\"}}))),/*#__PURE__*/React.createElement(\"div\",{className:\"button-group mt-3 mb-3\"},/*#__PURE__*/React.createElement(Col,{sm:12,xs:12,md:3},props.isOwner?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"live-action-icon-sec\"},/*#__PURE__*/React.createElement(\"ul\",{className:\"list-unstyled live-action-flex\"},/*#__PURE__*/React.createElement(Media,{as:\"li\"},/*#__PURE__*/React.createElement(Link,{to:\"#\",onClick:function onClick(){if(window.confirm(t(\"leave_call_confirmation\"))){leaveCall(props.isOwner);};}},/*#__PURE__*/React.createElement(Image,{src:window.location.origin+\"/assets/images/icons/end-stream.png\",className:\"action-live-icon\"}))),/*#__PURE__*/React.createElement(Media,{as:\"li\",id:\"mute-audio\"},/*#__PURE__*/React.createElement(Link,{to:\"#\",onClick:function onClick(){return muteAudio();}},/*#__PURE__*/React.createElement(Image,{src:window.location.origin+\"/assets/images/icons/audio.png\",className:\"action-live-icon\"}))),/*#__PURE__*/React.createElement(Media,{as:\"li\",id:\"unmute-audio\",style:{display:\"none\"}},/*#__PURE__*/React.createElement(Link,{to:\"#\",onClick:function onClick(){return muteAudio();}},/*#__PURE__*/React.createElement(Image,{src:window.location.origin+\"/assets/images/icons/no-audio.png\",className:\"action-live-icon\"}))),/*#__PURE__*/React.createElement(Media,{as:\"li\",id:\"mute-video\"},/*#__PURE__*/React.createElement(Link,{to:\"#\",onClick:function onClick(){return muteVideo();}},/*#__PURE__*/React.createElement(Image,{src:window.location.origin+\"/assets/images/icons/video.png\",className:\"action-live-icon\"}))),/*#__PURE__*/React.createElement(Media,{as:\"li\",id:\"unmute-video\",style:{display:\"none\"}},/*#__PURE__*/React.createElement(Link,{to:\"#\",onClick:function onClick(){return muteVideo();}},/*#__PURE__*/React.createElement(Image,{src:window.location.origin+\"/assets/images/icons/mute-video.png\",className:\"action-live-icon\"})))))):/*#__PURE__*/React.createElement(\"div\",{className:\"live-action-icon-sec\"},/*#__PURE__*/React.createElement(\"ul\",{className:\"list-unstyled live-action-flex\"},/*#__PURE__*/React.createElement(Media,{as:\"li\"},/*#__PURE__*/React.createElement(Link,{to:\"#\",onClick:function onClick(){if(window.confirm(t(\"leave_call_confirmation\"))){leaveCall(props.isOwner);};}},/*#__PURE__*/React.createElement(Image,{src:window.location.origin+\"/assets/images/icons/end-stream.png\",className:\"action-live-icon\"}))),/*#__PURE__*/React.createElement(Media,{as:\"li\",id:\"mute-audio\"},/*#__PURE__*/React.createElement(Link,{to:\"#\",onClick:function onClick(){return muteAudio();}},/*#__PURE__*/React.createElement(Image,{src:window.location.origin+\"/assets/images/icons/audio.png\",className:\"action-live-icon\"}))),/*#__PURE__*/React.createElement(Media,{as:\"li\",id:\"unmute-audio\",style:{display:\"none\"}},/*#__PURE__*/React.createElement(Link,{to:\"#\",onClick:function onClick(){return muteAudio();}},/*#__PURE__*/React.createElement(Image,{src:window.location.origin+\"/assets/images/icons/no-audio.png\",className:\"action-live-icon\"}))),/*#__PURE__*/React.createElement(Media,{as:\"li\",id:\"mute-video\"},/*#__PURE__*/React.createElement(Link,{to:\"#\",onClick:function onClick(){return muteVideo();}},/*#__PURE__*/React.createElement(Image,{src:window.location.origin+\"/assets/images/icons/video.png\",className:\"action-live-icon\"}))),/*#__PURE__*/React.createElement(Media,{as:\"li\",id:\"unmute-video\",style:{display:\"none\"}},/*#__PURE__*/React.createElement(Link,{to:\"#\",onClick:function onClick(){return muteVideo();}},/*#__PURE__*/React.createElement(Image,{src:window.location.origin+\"/assets/images/icons/mute-video.png\",className:\"action-live-icon\"}))))))));};var mapStateToPros=function mapStateToPros(state){return{};};function mapDispatchToProps(dispatch){return{dispatch:dispatch};}export default connect(mapStateToPros,mapDispatchToProps)(translate(AgoraOnetoOne));","map":{"version":3,"sources":["/home/codegama/bhawya/source_code/fx-frontend-base/src/components/Sample/AgoraOnetoOne.jsx"],"names":["React","useEffect","useState","connect","translate","t","AgoraRTC","Form","Button","Container","Row","Col","Table","Media","Image","endVideoCallStart","fetchSingleVideoCallStart","joinVideoCallStart","configuration","Link","client","createClient","mode","codec","$","window","AgoraOnetoOne","props","rtc","localAudioTrack","localVideoTrack","localTracks","videoTrack","audioTrack","localTrackState","videoTrackEnabled","audioTrackEnabled","options","appId","get","channel","token","uid","remoteUsers","startBasicCall","on","handleUserPublished","handleUserUnpublished","Promise","join","createMicrophoneAudioTrack","createCameraVideoTrack","all","play","publish","Object","values","console","log","dispatch","video_call_request_id","videoCallData","subscribe","user","mediaType","remoteVideoTrack","id","leaveCall","is_owner","close","forEach","playerContainer","document","getElementById","remove","leave","location","assign","muteAudio","setEnabled","hide","show","muteVideo","isOwner","width","height","confirm","origin","display","mapStateToPros","state","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport { translate, t } from \"react-multi-lang\";\nimport AgoraRTC from \"agora-rtc-sdk-ng\";\nimport { Form, Button, Container, Row, Col,Table,Media, Image  } from \"react-bootstrap\";\nimport {\n    endVideoCallStart,\n    fetchSingleVideoCallStart,\n    joinVideoCallStart,\n  } from \"../../store/actions/PrivateCallAction\";\nimport configuration from \"react-global-configuration\";\nimport { Link } from \"react-router-dom\";\n\nconst client = AgoraRTC.createClient({ mode: \"live\", codec: \"vp8\" });\nconst $ = window.$;\n\nconst AgoraOnetoOne = (props) => {\n\n    var rtc = {\n        // For the local client.\n        client: null,\n        // For the local audio and video tracks.\n        localAudioTrack: null,\n        localVideoTrack: null,\n    };\n      \n\n    var localTracks = {\n        videoTrack: null,\n        audioTrack: null\n    };\n\n    var localTrackState = {\n        videoTrackEnabled: true,\n        audioTrackEnabled: true\n    }\n\n    var options = {\n        // Pass your app ID here.\n        appId: configuration.get(\"configData.agora_app_id\"),\n        // Set the channel name.\n        channel: \"demo_channel_name\",\n        // Pass a token if your project enables the App Certificate.\n        token: null,\n        uid: null,\n    };\n    \n    var remoteUsers = {};\n\n    async function startBasicCall() {\n\n        rtc.client = AgoraRTC.createClient({ mode: \"rtc\", codec: \"vp8\" });\n\n        rtc.client.on(\"user-published\", handleUserPublished);\n        rtc.client.on(\"user-unpublished\", handleUserUnpublished);\n\n        [options.uid, localTracks.audioTrack, localTracks.videoTrack ] = await Promise.all([\n            // join the channel\n            await rtc.client.join(options.appId, options.channel, options.token, null),\n            // create local tracks, using microphone and camera\n            rtc.localAudioTrack = await AgoraRTC.createMicrophoneAudioTrack(),\n            rtc.localVideoTrack = await AgoraRTC.createCameraVideoTrack()\n        ]);\n\n          \n        localTracks.videoTrack.play(\"local-player\");\n\n        await rtc.client.publish(Object.values(localTracks));\n\n        // Publish the local audio and video tracks to the channel.\n        // await rtc.client.publish([rtc.localAudioTrack, rtc.localVideoTrack]);\n\n        console.log(\"publish success!\");\n\n        props.dispatch(\n            joinVideoCallStart({\n                video_call_request_id:props.videoCallData.video_call_request_id,\n            })\n        );\n\n\n    }\n\n    async function subscribe(user, mediaType) {\n        const uid = user.uid;\n        // subscribe to a remote user\n        await rtc.client.subscribe(user, mediaType);\n        console.log(\"subscribe success\");\n        if (mediaType === 'video') {\n          \n            const remoteVideoTrack = user.videoTrack;\n            remoteVideoTrack.play(\"remote-playerlist\");\n        }\n        if (mediaType === 'audio') {\n          user.audioTrack.play();\n        }\n    }\n\n    function handleUserPublished(user, mediaType) {\n        const id = user.uid;\n        remoteUsers[id] = user;\n        subscribe(user, mediaType);\n    }\n      \n    function handleUserUnpublished(user) {\n        // const id = user.uid;\n        // delete remoteUsers[id];\n        // $(`#player-wrapper-${id}`).remove();\n    }\n\n      \n    startBasicCall();\n\n    async function leaveCall(is_owner) {\n\n        if (is_owner) {\n          // Destroy the local audio and video tracks.\n          rtc.localAudioTrack.close();\n          rtc.localVideoTrack.close();\n      \n          // Traverse all remote users.\n          rtc.client.remoteUsers.forEach(user => {\n            // Destroy the dynamically created DIV container.\n            const playerContainer = document.getElementById(user.uid);\n            playerContainer && playerContainer.remove();\n          });\n          props.dispatch(\n            endVideoCallStart({\n                video_call_request_id:props.videoCallData.video_call_request_id,\n            })\n          );\n        } else {\n          // Leave the channel.\n          await rtc.client.leave();\n        } \n        \n        window.location.assign(\"/video-calls-history\");\n      }\n  \n      async function muteAudio() {\n        if (!rtc.localAudioTrack) return;\n        if(localTrackState.audioTrackEnabled == true) {\n            await rtc.localAudioTrack.setEnabled(false);\n            localTrackState.audioTrackEnabled = false;\n            $(\"#mute-audio\").hide();\n            $(\"#unmute-audio\").show();\n        } else {\n            await rtc.localAudioTrack.setEnabled(true);\n            localTrackState.audioTrackEnabled = true;\n            $(\"#mute-audio\").show();\n            $(\"#unmute-audio\").hide();\n        }\n      }\n      \n      async function muteVideo() {\n        if (!rtc.localVideoTrack) return;\n        if(localTrackState.videoTrackEnabled == true) {\n            await rtc.localVideoTrack.setEnabled(false);\n            localTrackState.videoTrackEnabled = false;\n            $(\"#mute-video\").hide();\n            $(\"#unmute-video\").show();\n        } else {\n            await rtc.localVideoTrack.setEnabled(true);\n            localTrackState.videoTrackEnabled = true;\n            $(\"#mute-video\").show();\n            $(\"#unmute-video\").hide();\n        }\n      }\n      console.log(props.isOwner);\n    return (\n        <div className=\"agora-card\">\n            <div>\n                <Col sm={12} xs={12} md={3}>\n                    <div id=\"local-player\" style={{ width: \"280px\", height: \"400px\" }} />\n                </Col>\n                <Col sm={12} xs={12} md={9}>\n                    <div id=\"remote-playerlist\" style={{ width: \"825px\", height: \"400px\" }} />\n                </Col>\n            </div>\n            <div className=\"button-group mt-3 mb-3\">\n                <Col sm={12} xs={12} md={3}>\n\n                {props.isOwner ? \n                    <>\n                    <div className=\"live-action-icon-sec\">\n                        <ul className=\"list-unstyled live-action-flex\">\n                            <Media as=\"li\">\n                                <Link to=\"#\" \n                                    onClick={() =>\n                                    {if(window.confirm(t(\"leave_call_confirmation\"))){ \n                                        leaveCall(props.isOwner)};}\n                                }>\n                                    <Image\n                                    src={\n                                        window.location.origin + \"/assets/images/icons/end-stream.png\"\n                                    }\n                                    className=\"action-live-icon\"\n                                    />\n                                </Link>\n                            </Media>\n                            <Media as=\"li\" id=\"mute-audio\">\n                                <Link to=\"#\"\n                                onClick={() =>\n                                    muteAudio()\n                                }>\n                                    <Image\n                                    src={\n                                        window.location.origin + \"/assets/images/icons/audio.png\"\n                                    }\n                                    className=\"action-live-icon\"\n                                    />\n                                </Link>\n                            </Media>\n                            <Media as=\"li\" id=\"unmute-audio\" style={{display: \"none\"}}>\n                                <Link to=\"#\"\n                                onClick={() =>\n                                    muteAudio()\n                                }>\n                                    <Image\n                                    src={\n                                        window.location.origin + \"/assets/images/icons/no-audio.png\"\n                                    }\n                                    className=\"action-live-icon\"\n                                    />\n                                </Link>\n                            </Media>\n                            <Media as=\"li\" id=\"mute-video\">\n                                <Link to=\"#\"\n                                onClick={() =>\n                                    muteVideo()\n                                }>\n                                    <Image\n                                    src={\n                                        window.location.origin + \"/assets/images/icons/video.png\"\n                                    }\n                                    className=\"action-live-icon\"\n                                    />\n                                </Link>\n                            </Media>\n                            <Media as=\"li\" id=\"unmute-video\" style={{display: \"none\"}}>\n                                <Link to=\"#\"\n                                onClick={() =>\n                                    muteVideo()\n                                }>\n                                    <Image\n                                    src={\n                                        window.location.origin + \"/assets/images/icons/mute-video.png\"\n                                    }\n                                    className=\"action-live-icon\"\n                                    />\n                                </Link>\n                            </Media>\n                        </ul>\n                    </div>\n                    </>\n                :\n                    <div className=\"live-action-icon-sec\">\n                        <ul className=\"list-unstyled live-action-flex\">\n                            <Media as=\"li\">\n                                <Link to=\"#\" \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() =>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{if(window.confirm(t(\"leave_call_confirmation\"))){ \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tleaveCall(props.isOwner)};}\n                                }>\n                                    <Image\n                                    src={\n                                        window.location.origin + \"/assets/images/icons/end-stream.png\"\n                                    }\n                                    className=\"action-live-icon\"\n                                    />\n                                </Link>\n                            </Media>\n                            <Media as=\"li\" id=\"mute-audio\">\n                                <Link to=\"#\"\n                                onClick={() =>\n                                    muteAudio()\n                                }>\n                                    <Image\n                                    src={\n                                        window.location.origin + \"/assets/images/icons/audio.png\"\n                                    }\n                                    className=\"action-live-icon\"\n                                    />\n                                </Link>\n                            </Media>\n                            <Media as=\"li\" id=\"unmute-audio\" style={{display: \"none\"}}>\n                                <Link to=\"#\"\n                                onClick={() =>\n                                    muteAudio()\n                                }>\n                                    <Image\n                                    src={\n                                        window.location.origin + \"/assets/images/icons/no-audio.png\"\n                                    }\n                                    className=\"action-live-icon\"\n                                    />\n                                </Link>\n                            </Media>\n                            <Media as=\"li\" id=\"mute-video\">\n                                <Link to=\"#\"\n                                onClick={() =>\n                                    muteVideo()\n                                }>\n                                    <Image\n                                    src={\n                                        window.location.origin + \"/assets/images/icons/video.png\"\n                                    }\n                                    className=\"action-live-icon\"\n                                    />\n                                </Link>\n                            </Media>\n                            <Media as=\"li\" id=\"unmute-video\" style={{display: \"none\"}}>\n                                <Link to=\"#\"\n                                onClick={() =>\n                                    muteVideo()\n                                }>\n                                    <Image\n                                    src={\n                                        window.location.origin + \"/assets/images/icons/mute-video.png\"\n                                    }\n                                    className=\"action-live-icon\"\n                                    />\n                                </Link>\n                            </Media>\n                        </ul>\n                    </div>\n                }\n\n                </Col>\n            </div>\n\n            {/* <div className=\"button-group\">\n                \n                <Button \n                    id=\"mute-audio\"  \n                    type=\"button\" \n                    className=\"save-btn\"\n                    onClick={() =>\n                        muteAudio()\n                    }\n                >\n                    Mute Audio\n                </Button>\n                <Button \n                    id=\"mute-video\" \n                    type=\"button\" \n                    onClick={() =>\n                        muteVideo()\n                    }\n                    className=\"save-btn\"\n                >\n                    Mute Video\n                </Button>\n\n                <Button\n                    className=\"save-btn\"\n                    type=\"submit\"\n                    onClick={() =>\n                        leaveCall(props.isOwner)\n                    }\n                >\n                    {props.isOwner ? \"End Streaming\" : \"Leave\" }\n                </Button>\n                \n                \n            </div> */}\n        </div>\n        \n    );\n};\n\n\nconst mapStateToPros = (state) => ({\n  \n});\n\nfunction mapDispatchToProps(dispatch) {\nreturn { dispatch };\n}\n\nexport default connect(mapStateToPros, mapDispatchToProps)(translate(AgoraOnetoOne));"]},"metadata":{},"sourceType":"module"}